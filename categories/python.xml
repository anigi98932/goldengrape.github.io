<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>GoldenGrape's Blog (关于文章 python)</title><link>https://goldengrape.github.io/</link><description></description><atom:link href="https://goldengrape.github.io/categories/python.xml" rel="self" type="application/rss+xml"></atom:link><language>zh_cn</language><copyright>Contents © 2019 &lt;a href="mailto:https://twitter.com/goldengrape"&gt;Golden Grape&lt;/a&gt; </copyright><lastBuildDate>Mon, 01 Jul 2019 08:47:00 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>抗偏位非球面人工晶体设计</title><link>https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/</link><dc:creator>Golden Grape</dc:creator><description>&lt;div&gt;&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;先给非眼科学的读者介绍一下知识背景。1949年，Ridly爵士发明了人工晶状体（Intraocluar lens，IOL，人工晶体），是一枚有机玻璃镜片，可以植入到眼内，替代人眼的天然晶状体。这是唯一，也是非常有效的治疗白内障的方法，将因为白内障浑浊的天然晶状体，更换成人工晶体。&lt;/p&gt;
&lt;p&gt;早期人工晶体的加工和光学设计显然是和光学镜头一致的，是球面镜。人工晶体的材料逐渐从硬质的PMMA，进化到了有弹性可折叠的硅胶、亲水/疏水丙烯酸酯、胶原等材料，切口也越来越小。但人工晶体的光学设计一直到1990s末才发生改变。&lt;/p&gt;
&lt;p&gt;人眼的角膜，是具有球差的，是一个“正球差”的凸透镜，也就是说，周边的屈光力更强，中央的弱一些，周边的光线会被聚焦得更&lt;strong&gt;近&lt;/strong&gt; ，人眼的晶状体，这东西不但形状不是标准球面镜，内部的折射率还是渐变的，最终的结果是人眼的晶状体是一个“负球差”的透镜。一定程度上，两个透镜的结合导致球差能够互相抵消一部分。&lt;/p&gt;
&lt;p&gt;对于球面镜的人工晶体，一定是一枚“正球差”的凸透镜，所以，即使屈光度计算正确，仍然会与角膜搭配增加球差。于是眼科医生们希望能够设计出非球面的人工晶体。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;参考文献1:姚克, 陆道炎, 王丽天, 等. 非球面等视像后房型人工晶状体的临床应用. 中华眼科杂志, 1989, 25:262-264.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.ncbi.nlm.nih.gov/pubmed/12458861"&gt;参考文献2: A new intraocular lens design to reduce spherical aberration of pseudophakic eyes.&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;第一枚上市的非球面人工晶体是AMO公司(现在属于强生)的Tecnis Z9000, &lt;a href="https://www.accessdata.fda.gov/scripts/cdrh/cfdocs/cfpma/pma.cfm?id=P990080S001"&gt;FDA: 09/05/2001 &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;非球面IOL上市以后，人们发现，由于IOL是通过手术植入的，多多少少可能有些偏位，也就是人工晶体的光学中心与角膜的光轴可能有差距。这个量很小，只有0.x mm。当消球差的两个非球面镜之间发生偏位的时候，平行光入射，会发生偏移，会形成新的像差，叫做慧差，于是一部分厂商认为慧差也是需要纠正的。&lt;/p&gt;
&lt;p&gt;但在术前并无法知道术后IOL的偏位量，所以博士伦公司推出了“零球差”的IOL，也就是较少矫正角膜球差，虽然可能有偏位，但并不因为偏位而产生慧差。&lt;/p&gt;
&lt;p&gt;在此之后，更多的厂商利用光学设计推出了“抗偏位”的非球面人工晶体，也就是说，在矫正角膜球差的基础上，即使发生了偏位，也不会引起比较大的慧差。&lt;/p&gt;
&lt;p&gt;相应的，各个厂商也给自己的非球面人工晶体起了各种名字，比如：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HOYA： 非球面平衡曲线（ABC曲线）&lt;/li&gt;
&lt;li&gt;爱博诺德：高次非球面&lt;/li&gt;
&lt;li&gt;蕾明视康：轴向渐进非球面&lt;/li&gt;
&lt;li&gt;蔡司：非恒定像差&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;那么接下来就讲解抗偏位非球面人工晶体设计的基本原理。
&lt;!-- TEASER_END --&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="定理"&gt;定理&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E5%AE%9A%E7%90%86"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;“当你需要深入了解时，一定在眼科书里找不到详细。”&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="工具"&gt;工具&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E5%B7%A5%E5%85%B7"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;工业用光学设计软件：&lt;ul&gt;
&lt;li&gt;Zemax: 专业工具，人工晶体设计厂商常用，昂贵&lt;/li&gt;
&lt;li&gt;OSLO EDU：教学版本免费，一些功能受到限制&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;此次演示使用Python，我们从0开始，演示如何建一个轮子。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;需要的知识：&lt;ul&gt;
&lt;li&gt;高数：求微分&lt;/li&gt;
&lt;li&gt;线性代数：向量乘法&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;ipywidgets&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;interact&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;interactive&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fixed&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;interact_manual&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;ipywidgets&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;widgets&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;lmfit&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;minimize&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Parameters&lt;/span&gt;

&lt;span class="c1"&gt;#matplotlib inline&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="非球面的表示法"&gt;非球面的表示法&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E9%9D%9E%E7%90%83%E9%9D%A2%E7%9A%84%E8%A1%A8%E7%A4%BA%E6%B3%95"&gt;¶&lt;/a&gt;&lt;/h2&gt;$$
z(r)=\frac{r^{2}}{R\left(1+\sqrt{1-(1 + \kappa) \frac{r^{2}}{R^{2}}}\right)}+\alpha_{4} r^{4}+\alpha_{6} r^{6}+\cdots
$$&lt;ul&gt;
&lt;li&gt;r 曲面到光轴的距离，假定是轴对称的曲面，r只有偶数次幂级数&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="描述一个非球面镜的参数："&gt;描述一个非球面镜的参数：&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E6%8F%8F%E8%BF%B0%E4%B8%80%E4%B8%AA%E9%9D%9E%E7%90%83%E9%9D%A2%E9%95%9C%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%9A"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;R：曲率半径&lt;/li&gt;
&lt;li&gt;$\kappa$&lt;ul&gt;
&lt;li&gt;眼科常使用Q来代替$\kappa$&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th style="text-align:left"&gt;$\kappa$&lt;/th&gt;
&lt;th style="text-align:left"&gt;意义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align:left"&gt;$\kappa$ &amp;lt; -1&lt;/td&gt;
&lt;td style="text-align:left"&gt;双曲线&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:left"&gt;$\kappa$ = -1&lt;/td&gt;
&lt;td style="text-align:left"&gt;抛物线&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:left"&gt;-1 &amp;lt; $\kappa$ &amp;lt; 0&lt;/td&gt;
&lt;td style="text-align:left"&gt;椭圆（prolate spheroid)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:left"&gt;$\kappa$ = 0&lt;/td&gt;
&lt;td style="text-align:left"&gt;圆&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align:left"&gt;$\kappa$ &amp;gt; 0&lt;/td&gt;
&lt;td style="text-align:left"&gt;椭圆 （oblate spheroid）&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;高次项系数：$\alpha_{4},\alpha_{6},\alpha_{8},\alpha_{10},\cdots$&lt;/li&gt;
&lt;li&gt;镜面中心顶点的位置&lt;/li&gt;
&lt;li&gt;镜面两侧介质的折射率&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;z&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;kappa&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'a'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;partA&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;kappa&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;
    &lt;span class="n"&gt;partB&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;partB&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;partA&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;partB&lt;/span&gt; 

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;surface&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;z0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;r0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"apex"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;z0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="ABC曲线图示："&gt;ABC曲线图示：&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#ABC%E6%9B%B2%E7%BA%BF%E5%9B%BE%E7%A4%BA%EF%BC%9A"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;如果直接看镜片的剖面，肉眼是很难分辨出来到底是球面，还是非球面，还是其他更复杂的非球面。于是有一种给眼科大夫们介绍的时候，厂商会使用一种光焦度图，横轴是IOL上某一点到光轴的距离r，纵轴是光焦度或者说屈光度。&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;对函数z(r)上每一点的曲率半径：
$$
Radius=\frac{\left|z^{\prime \prime}(r)\right|}{\left(1+z^{\prime 2}(r)\right)^{3 / 2}}
$$
换算成屈光度
$$
Power=\frac{N_2-N_1}{Radius} \\
Power = \frac{(N_2-N_1)\left(1+z^{\prime 2}(r)\right)^{3 / 2}}{\left|z^{\prime \prime}(r)\right|}
$$
其中$N_1,N_2$是镜面两侧的折射率&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;已知:&lt;/p&gt;
$$
z(r)=\frac{r^{2}}{R\left(1+\sqrt{1-(1 + \kappa) \frac{r^{2}}{R^{2}}}\right)}+\alpha_{4} r^{4}+\alpha_{6} r^{6}+\cdots
$$&lt;p&gt;一阶导数: 
$$
z^{\prime}=\frac {\partial z}{\partial r} = \frac{r}{R \sqrt{1-\frac{r^{2}(1+\kappa)}{R^{2}}}} + 4 a_4 r^{3}+6 a_6 r^{5}+ \cdots
$$
二阶导数：&lt;/p&gt;
$$
z^{\prime \prime}=\frac {\partial ^2 z}{\partial r^2} =\frac{R^{3} \sqrt{1-\frac{r^{2}(1+\kappa)}{R^{2}}}}{\left(R^{2}-r^{2}(1+\kappa)\right)^{2}}+12 a_4 r^{2}+30 a_6 r^{4}+ \cdots
$$
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;dz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;kappa&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'a'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="c1"&gt;# z'&lt;/span&gt;
    &lt;span class="n"&gt;dz_partA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;kappa&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; 
    &lt;span class="n"&gt;dz_partB&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;dz_partB&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dz_partA&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dz_partB&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;dz2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;kappa&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'a'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;dz2_partA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;kappa&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;kappa&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;dz2_partB&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
        &lt;span class="n"&gt;dz2_partB&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;dz2_partA&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dz2_partB&lt;/span&gt;
    
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;surface_power&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'refractive_index'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;d1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;d2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dz2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;power&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n2&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;d1&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;power&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="测试绘图"&gt;测试绘图&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E6%B5%8B%E8%AF%95%E7%BB%98%E5%9B%BE"&gt;¶&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;draw_surface&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;surface&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'apex'&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'apex'&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;draw_power&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_power&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;surface_0&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;# 𝜅  &amp;gt; 0	椭圆 （oblate spheroid）&lt;/span&gt;
    &lt;span class="s2"&gt;"a"&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;'apex'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;'refractive_index'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;0.9&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# before and after&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h4 id="透镜剖面图"&gt;透镜剖面图&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E9%80%8F%E9%95%9C%E5%89%96%E9%9D%A2%E5%9B%BE"&gt;¶&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'equal'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;draw_surface&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surface_0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h4 id="透镜屈光度图"&gt;透镜屈光度图&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E9%80%8F%E9%95%9C%E5%B1%88%E5%85%89%E5%BA%A6%E5%9B%BE"&gt;¶&lt;/a&gt;&lt;/h4&gt;&lt;p&gt;𝜅  &amp;gt; 0  椭圆 （oblate spheroid），中央屈光度更高，周边逐渐降低，这是一个“负球差”透镜&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;draw_power&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surface_0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Ray-Tracing（光路追迹，光线追踪）"&gt;Ray Tracing（光路追迹，光线追踪）&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#Ray-Tracing%EF%BC%88%E5%85%89%E8%B7%AF%E8%BF%BD%E8%BF%B9%EF%BC%8C%E5%85%89%E7%BA%BF%E8%BF%BD%E8%B8%AA%EF%BC%89"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;光线在均一介质中传播&lt;/li&gt;
&lt;li&gt;光线在界面上的折射&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="光线在均一介质中传播"&gt;光线在均一介质中传播&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E5%85%89%E7%BA%BF%E5%9C%A8%E5%9D%87%E4%B8%80%E4%BB%8B%E8%B4%A8%E4%B8%AD%E4%BC%A0%E6%92%AD"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;直线的方程, 从点$P_0$沿着方向矢量$\vec l$ 传播距离d, 到达点$P(d)$&lt;/p&gt;
$$
P(d)=P_0+d  \vec l  
$$&lt;p&gt;考虑r方向和z方向两个分量
$$
P(d)_r=P_{0r}+d_r  l_r \\
P(d)_z=P_{0z}+d_z  l_z \\
其中 \frac{d_r}{d_z}=\frac{l_r}{l_z}
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;travel_in_space&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;vec_l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dz&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;vec_lz&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;vec_l&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;vec_l_in_z&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;vec_l&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;vec_lz&lt;/span&gt;
    &lt;span class="n"&gt;dz&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dz&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;pdz&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;p0&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;dz&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;vec_l_in_z&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pdz&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="折射"&gt;折射&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E6%8A%98%E5%B0%84"&gt;¶&lt;/a&gt;&lt;/h2&gt;$$
n_1 Sin(\theta_1) = n_2 Sin(\theta_2)
$$&lt;p&gt;参考 &lt;a href="https://en.wikipedia.org/wiki/Snell's_law"&gt;https://en.wikipedia.org/wiki/Snell's_law&lt;/a&gt; 中的矢量形式&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;入射光方向: $\vec l$&lt;/li&gt;
&lt;li&gt;曲面的法向量: $\vec n$&lt;/li&gt;
&lt;li&gt;入射面介质折射率: $n_1$&lt;/li&gt;
&lt;li&gt;出射面介质折射率: $n_2$&lt;/li&gt;
&lt;/ul&gt;
$$
r=n_1/n_2\\
c=-\vec n \cdot \vec l \\
\vec V_{refract}=r\vec l+(rc-\sqrt{1-r^2(1-c^2)})\vec n
$$
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;V_refract&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec_l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;vec_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;n1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;n2&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec_l&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;diag&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;matmul&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;transpose&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec_l&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;matmul&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec_n&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;vec_l&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reshape&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;    
    &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;vec_l&lt;/span&gt;  &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;vec_n&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;keepdims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 测试：&lt;/span&gt;
&lt;span class="n"&gt;vec_l&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mf"&gt;0.707107&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.707107&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.707107&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.707107&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mf"&gt;0.707107&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.707107&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;span class="n"&gt;vec_n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;span class="n"&gt;n1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;n2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;0.9&lt;/span&gt;
&lt;span class="n"&gt;V_refract&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec_l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;vec_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# should be:&lt;/span&gt;
&lt;span class="c1"&gt;# [ 0.6364, -0.7714]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[10]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;array([[ 0.63639614, -0.7713624 ],
       [ 0.63639614, -0.7713624 ],
       [ 0.63639614, -0.7713624 ]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="曲面的法向量:-$\vec-n$"&gt;曲面的法向量: $\vec n$&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E6%9B%B2%E9%9D%A2%E7%9A%84%E6%B3%95%E5%90%91%E9%87%8F:-%24%5Cvec-n%24"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;简化，仅仅考虑二维&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;已知有曲面
$$
z=z(r)
$$
则曲面在(z0,r0)位置的法向量: 
$$
\left[ 
\begin{array}{c} 
-1\\ 
\frac{\partial }{\partial r}z\left(r \right) |_{r=r0} 
\end{array} 
\right]
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;norm_vec&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;kappa&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'a'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    
    &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shape&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;dz&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;norm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;keepdims&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h4 id="绘制曲面上的法向量"&gt;绘制曲面上的法向量&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E7%BB%98%E5%88%B6%E6%9B%B2%E9%9D%A2%E4%B8%8A%E7%9A%84%E6%B3%95%E5%90%91%E9%87%8F"&gt;¶&lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'equal'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# 绘制曲面&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;draw_surface&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surface_0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 计算法向量&lt;/span&gt;
&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="n"&gt;rn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;norm_v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;norm_vec&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;zn&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;surface&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surface_0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;zn1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;zn&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;norm_v&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;rn1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rn&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;norm_v&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;zn&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;zn1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]],[&lt;/span&gt;&lt;span class="n"&gt;rn&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;rn1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="在曲面上折射"&gt;在曲面上折射&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E5%9C%A8%E6%9B%B2%E9%9D%A2%E4%B8%8A%E6%8A%98%E5%B0%84"&gt;¶&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;refract_from_surface&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vec_l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;z0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;r0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"apex"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'refractive_index'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r0&lt;/span&gt;
    &lt;span class="n"&gt;vec_n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;norm_vec&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_parameter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;V_refract&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vec_l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;vec_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="薄透镜近似"&gt;薄透镜近似&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E8%96%84%E9%80%8F%E9%95%9C%E8%BF%91%E4%BC%BC"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;薄透镜&lt;ul&gt;
&lt;li&gt;直线与曲线的交点，化简成为直线与直线的交点. &lt;strong&gt;这个简化大大降低了运算难度，但也引入很大误差&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;暂不考虑瞳孔大小&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="已知模型，模拟成像过程"&gt;已知模型，模拟成像过程&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E5%B7%B2%E7%9F%A5%E6%A8%A1%E5%9E%8B%EF%BC%8C%E6%A8%A1%E6%8B%9F%E6%88%90%E5%83%8F%E8%BF%87%E7%A8%8B"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;一组平行光，经过两个非球面镜，聚焦到屏幕上。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;非球面镜0: 镜头垂直于光轴，镜头中心位于光轴上，是一个简单的椭球面&lt;/li&gt;
&lt;li&gt;非球面镜1: 镜头垂直于光轴，但镜头中心有一定的偏位&lt;/li&gt;
&lt;li&gt;屏幕：垂直于光轴&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;surface_0&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"a"&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;'apex'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;'refractive_index'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;1.3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# before and after&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;surface_1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"a"&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;'apex'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;'refractive_index'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mf"&gt;1.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# before and after&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;surface_2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;1e+10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"a"&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;'apex'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;'refractive_index'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# before and after&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Ray-Tracing（光路追迹，光线追踪）"&gt;Ray Tracing（光路追迹，光线追踪）&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#Ray-Tracing%EF%BC%88%E5%85%89%E8%B7%AF%E8%BF%BD%E8%BF%B9%EF%BC%8C%E5%85%89%E7%BA%BF%E8%BF%BD%E8%B8%AA%EF%BC%89"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;追踪每一条光线所走的路径：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在均一介质内直线行进：位置改变，方向不变&lt;/li&gt;
&lt;li&gt;在镜头界面上折射：位置不变，方向改变&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;依次穿过每一个透镜界面，计算出最终在屏幕上光线的位置&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [15]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;ray_tracing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;light_position_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;light_direction_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surfaces&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="c1"&gt;# 记录光线的位置&lt;/span&gt;
    &lt;span class="n"&gt;light_postion_list&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;light_position_start&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    
    &lt;span class="c1"&gt;# 从被追踪光线的起始位置和起始方向开始：&lt;/span&gt;
    &lt;span class="n"&gt;light_position&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;light_position_start&lt;/span&gt;
    &lt;span class="n"&gt;light_direction&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;light_direction_start&lt;/span&gt;
    
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;surfaces&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;# 遍历每一个曲面&lt;/span&gt;
        &lt;span class="c1"&gt;#光线在均匀介质内传播，到达该曲面&lt;/span&gt;
        &lt;span class="n"&gt;dz&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'apex'&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;light_position&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;light_position&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;travel_in_space&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;light_position&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;light_direction&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;dz&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="c1"&gt;#光线经过该曲面发生折射&lt;/span&gt;
        &lt;span class="n"&gt;light_direction&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;refract_from_surface&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;light_position&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;light_direction&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="c1"&gt;#记录下光线的位置&lt;/span&gt;
        &lt;span class="n"&gt;light_postion_list&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;light_position&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;light_postion_list&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [16]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;init_light&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;#初始化光线&lt;/span&gt;
    &lt;span class="n"&gt;light_position_start&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;#从z=-5平面开始发出光线&lt;/span&gt;
    &lt;span class="n"&gt;light_position_start&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;light_direction_start&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;light_direction_start&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="c1"&gt;#方向矢量(1,0)，指向Z轴方向&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;light_position_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;light_direction_start&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [17]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;draw_ray_tracing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surfaces&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# 绘制出各个曲面的位置：&lt;/span&gt;
    &lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'equal'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;surfaces&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;draw_surface&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# 光线的起点和方向&lt;/span&gt;
&lt;span class="c1"&gt;#     N=3 # 光线数量&lt;/span&gt;
    &lt;span class="n"&gt;light_position_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;light_direction_start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;init_light&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# 追踪光线，获得光线在各个曲面上经过时的坐标&lt;/span&gt;
    &lt;span class="n"&gt;light_postion_list&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ray_tracing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;light_position_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;light_direction_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surfaces&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# 绘制出每一根光线&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;light_postion&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;light_postion&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;light_postion_list&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;light_postion&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;light_postion&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;light_postion_list&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;#     ax.set_xlim(28, 32)&lt;/span&gt;
&lt;span class="c1"&gt;#     ax.set_ylim(-2,2)&lt;/span&gt;
    &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [18]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 绘制ray tracing过程：&lt;/span&gt;
&lt;span class="n"&gt;draw_ray_tracing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,[&lt;/span&gt;&lt;span class="n"&gt;surface_0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stderr output_text"&gt;
&lt;pre&gt;/Users/goldengrape/anaconda3/envs/blog/lib/python3.6/site-packages/ipykernel_launcher.py:5: RuntimeWarning: invalid value encountered in sqrt
  """
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="未知模型，求解最佳参数"&gt;未知模型，求解最佳参数&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E6%9C%AA%E7%9F%A5%E6%A8%A1%E5%9E%8B%EF%BC%8C%E6%B1%82%E8%A7%A3%E6%9C%80%E4%BD%B3%E5%8F%82%E6%95%B0"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;一组平行光，经过两个非球面镜，聚焦到屏幕上。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;非球面镜0: 镜头垂直于光轴，镜头中心位于光轴上，是一个简单的椭球面&lt;/li&gt;
&lt;li&gt;非球面镜1: 镜头垂直于光轴，但镜头中心在一定范围内偏位&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="优化模型"&gt;优化模型&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E4%BC%98%E5%8C%96%E6%A8%A1%E5%9E%8B"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;当非球面镜1偏位时，每一条光线最好都能够落在焦点附近，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;注意：由于镜头偏位，所以焦点并不一定在光轴上，&lt;ul&gt;
&lt;li&gt;“焦点”，各个光线汇聚的点，或者说，光线的平均位置。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;简化：每一条光线在屏上的位置 &lt;strong&gt;尽量靠近&lt;/strong&gt; 非球面镜1的偏位距离&lt;ul&gt;
&lt;li&gt;尽量靠近：到达给定位置的平方和最小&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;优化问题： 求loss&lt;em&gt;function的最小值：
$$
loss =\sum&lt;/em&gt;{偏位距离=-\Delta}^{+\Delta} \sum_{光线_i =0 }^{N} |光线_i 在屏上位置- 非球面镜_1 的偏位距离|^2
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [19]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;loss_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;light_position_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;light_direction_start&lt;/span&gt;  &lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="n"&gt;spots_on_screen_list&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;Delta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.9&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;apex_r&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;Delta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;Delta&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="c1"&gt;# 将曲面在一定范围内移动&lt;/span&gt;
    
        &lt;span class="n"&gt;surface_t&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="s2"&gt;"a"&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"a4"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"a6"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'a8'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'a10'&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt;
            &lt;span class="s1"&gt;'apex'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;apex_r&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="s1"&gt;'refractive_index'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mf"&gt;1.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# before and after&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="n"&gt;surfaces&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;surface_0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;surface_2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; 

        &lt;span class="c1"&gt;# 追踪光线，获得光线在各个曲面上经过时的坐标&lt;/span&gt;
        &lt;span class="n"&gt;light_postion_list&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ray_tracing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;light_position_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;light_direction_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surfaces&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        
        &lt;span class="c1"&gt;# 希望屏上的光线落在偏位点的附近&lt;/span&gt;
        &lt;span class="n"&gt;spots_on_screen&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;light_postion_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;][:,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;apex_r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;spots_on_screen_list&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;spots_on_screen&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;spots_on_screen_list&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="优化器"&gt;优化器&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E4%BC%98%E5%8C%96%E5%99%A8"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;lmfit，scipy优化器的封装，&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;设定好需要优化的参数: $ R, \kappa, a_4,a_6,a_8,a_{10} $ &lt;/li&gt;
&lt;li&gt;设定目标loss_function&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;求解使得loss_function取得最小值的参数表&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [20]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;lmfit&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Minimizer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Parameters&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;report_fit&lt;/span&gt;

&lt;span class="c1"&gt;# 定义待求解的参数，以及初值，参数的数值范围&lt;/span&gt;
&lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameters&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="c1"&gt;# add with tuples:(NAME,    初始值,  求解， Min    MAX   EXPR  BRUTE_STEP)&lt;/span&gt;
&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_many&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'R'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;     &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;      &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;     &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'kappa'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;      &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'a4'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;    &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;      &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'a6'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;    &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;      &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'a8'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;    &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;      &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'a10'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;      &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
               &lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="c1"&gt;# 输入N条光线&lt;/span&gt;
&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;
&lt;span class="n"&gt;light_position_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;light_direction_start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;init_light&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 求解参数&lt;/span&gt;
&lt;span class="n"&gt;minner&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Minimizer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;loss_function&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                   &lt;span class="n"&gt;fcn_args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;light_position_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;light_direction_start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                   &lt;span class="n"&gt;nan_policy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"propagate"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;minner&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;minimize&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="结果"&gt;结果&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/#%E7%BB%93%E6%9E%9C"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [21]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"R=&lt;/span&gt;&lt;span class="si"&gt;{:.2f}&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"kappa=&lt;/span&gt;&lt;span class="si"&gt;{:.2f}&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"a4=&lt;/span&gt;&lt;span class="si"&gt;{:.2e}&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"a4"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"a6=&lt;/span&gt;&lt;span class="si"&gt;{:.2e}&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"a6"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"a8=&lt;/span&gt;&lt;span class="si"&gt;{:.2e}&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"a8"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"a10=&lt;/span&gt;&lt;span class="si"&gt;{:.2e}&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"a10"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;R=6.02
kappa=1.34
a4=-4.52e-02
a6=-2.28e-03
a8=4.15e-04
a10=-2.71e-05
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [22]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_surface_target&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;apex_r&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"R"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"kappa"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s2"&gt;"a"&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"a4"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"a6"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'a8'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                 &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'a10'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="s1"&gt;'apex'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;apex_r&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="s1"&gt;'refractive_index'&lt;/span&gt;&lt;span class="p"&gt;:[&lt;/span&gt;&lt;span class="mf"&gt;1.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# before and after&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [26]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# surface 0 的光焦度曲线&lt;/span&gt;
&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;draw_power&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;surface_0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [27]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# surface 1 的光焦度曲线&lt;/span&gt;
&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="c1"&gt;# plt.axis('equal')&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# ax=draw_surface(r, surface_0, ax)&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;draw_power&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;get_surface_target&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [28]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 不同偏位状态时的聚焦情况&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;apex_r&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;draw_ray_tracing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,[&lt;/span&gt;&lt;span class="n"&gt;surface_0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;get_surface_target&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;apex_r&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;surface_2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stderr output_text"&gt;
&lt;pre&gt;/Users/goldengrape/anaconda3/envs/blog/lib/python3.6/site-packages/ipykernel_launcher.py:5: RuntimeWarning: invalid value encountered in sqrt
  """
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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"&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;&lt;/div&gt;</description><category>python</category><guid>https://goldengrape.github.io/posts/python/asphereicle_anti_decenter/</guid><pubDate>Fri, 31 May 2019 04:00:00 GMT</pubDate></item><item><title>那些在线的jupyter</title><link>https://goldengrape.github.io/posts/python/na-xie-zai-xian-de-jupyter/</link><dc:creator>Golden Grape</dc:creator><description>&lt;div&gt;&lt;h4&gt;update:&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Data School有一篇非常好的评测，写了6个在线的Jupyter服务，建议去看看。
&lt;a href="https://www.dataschool.io/cloud-services-for-jupyter-notebook/"&gt;Six easy ways to run your Jupyter Notebook in the cloud&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这里还有一个太长不看的&lt;a href="https://docs.google.com/spreadsheets/d/12thaaXg1Idr3iWST8QyASNDs08sjdPd6m9mbCGtHFn0"&gt;总结表格&lt;/a&gt;。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;以下部分写于2年前，部分内容与现实略有差异&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;Jupyter&lt;/h2&gt;
&lt;p&gt;如果你是python的初学者, 非常推荐Jupyter.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://goldengrape.github.io/posts/python/na-xie-zai-xian-de-jupyter/Jupyter.org"&gt;Juypter&lt;/a&gt;是一个交互式的编程环境,  号称&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;The Notebook has support for over 40 programming languages,
including Python, R, Julia, and Scala.
&lt;/pre&gt;


&lt;p&gt;支持超过40种语言, 其中包括Python,  R,  Julia和Scala. 虽然除了Python, 目前提到的其他语言我还都不会, 但是看起来是很强大很有前途的样子.
&lt;!-- TEASER_END --&gt;&lt;/p&gt;
&lt;p&gt;Jupyter的编程环境我很喜欢, 你可以写一段markdown图文并茂的说明, 再写一段代码, 然后单独运行刚刚写过的这一段代码, 看到结果, 调试代码, 改好以后再进行下一段.&lt;/p&gt;
&lt;p&gt;最终完成的文本+代码, 是所谓的&lt;a href="https://zh.wikipedia.org/wiki/%E6%96%87%E5%AD%A6%E7%BC%96%E7%A8%8B"&gt;"文学编程"&lt;/a&gt;, 文字甚至图片说明作者的思路, 中间夹杂着代码, 来教导计算机进行操作. 这样带来了完美的可读性.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="sx"&gt;!不要! 相信什么"代码才是最好的注释".&lt;/span&gt;
那是穿格子衬衫背双肩背半夜三点还在写代码的专职程序员才相信的东西&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;如果你不是一个每天必须写代码十几个小时的专业程序员, 而是利用代码去完成自己专业的特殊需求, 可能一个程序要间断好多天才能写完, 那么这种方式能够帮你迅速找到前几天的思路. 继续完成之前的作品.&lt;/p&gt;
&lt;h2&gt;在本地安装Jupyter(跳过吧, 别看)&lt;/h2&gt;
&lt;p&gt;Jupyter当然可以安装在本地, 安装好&lt;a href="https://www.anaconda.com/"&gt;Anaconda&lt;/a&gt;以后, 相对比较容易安装jupyter了.  &lt;/p&gt;
&lt;p&gt;但如果你之前只在windows上安装过商业软件, 一路点next, 或者在mac上从dmg中把应用程序直接拖动到文件夹里就可以运行. 那么安装anaconda, jupyter, 以及在运行jupyter时再安装各种python的依赖包, 是非常痛苦的.&lt;/p&gt;
&lt;p&gt;完全不建议新手进行, 至于那些常年泡在&lt;a href="https://twitter.com/bgm38/status/932512531251216385"&gt;linux里面已经 "&lt;strong&gt;久病成医&lt;/strong&gt; "&lt;/a&gt;的病友, 推荐你们试试.&lt;/p&gt;
&lt;h2&gt;在线的Jupyter&lt;/h2&gt;
&lt;p&gt;如果你是python的初学者, 非常推荐使用在线的Jupyter.&lt;/p&gt;
&lt;p&gt;利用在线的Jupyter要轻松得多, 只需要有网络连接, 有浏览器就可以了. 我测试了mac版的Chrome, Safari, 甚至android上的Chrome和iOS上的Safari, Chrome, 都可以运行在线的Jupyter.&lt;/p&gt;
&lt;p&gt;目前已经有这些服务:&lt;/p&gt;
&lt;h3&gt;Cocalc&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://cocalc.com"&gt;https://cocalc.com&lt;/a&gt; ,
这是一个科学计算平台, 除了提供jupyter, 还提供了sagemath.
sagemath也是一个强大的数学计算工具, 可以当作一个开源的mathematica, 随手解个方程, 求个微分之列都很方便.&lt;/p&gt;
&lt;p&gt;CoCalc已经安装好了大量的python包, 比如numpy, tensorflow, keras, pytorch. . .&lt;/p&gt;
&lt;p&gt;Cocalc有免费版和付费版, 免费版没有额外的网络连接, 也就是说你无法在cocalc里面再访问其他网页, 比如你用jupyter写了一个网络服务程序, 那么是无法用在cocalc免费版里面的. 用git也会受限制. 没有网络连接最麻烦的是如果cocalc没有预装的包, 你是无法自行安装的. 不过如果确实是很常用有名的python包, 那么可以向cocalc网站的支持发个email, 他们的响应速度超级快, 很有可能就帮你装好了.&lt;/p&gt;
&lt;p&gt;我写过&lt;a href="https://goldengrape.github.io/Python-for-ophthalmologist/lesson_01_jupyter.html"&gt;CoCalc的使用教程&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Azure notebook&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://notebooks.azure.com"&gt;https://notebooks.azure.com&lt;/a&gt;
这是微软提供的在线jupyter服务, 财大气粗的微软提供的内存, cpu, 存储空间都不错.&lt;/p&gt;
&lt;p&gt;很有特色的功能有二:
1. 方便一键clone, 看好其他人的做得不错的东西, 可以方便clone一份自己研究.
2. 可以从github导入, 只需要将看中的github repo页面添加, 就可以自动clone, 如果对方更新了, 自己这边也可以方便使用git pull&lt;/p&gt;
&lt;p&gt;微软的这个服务是有网络连接的, 你可以远程下载数据或者导入其他的库. 因此如果出现没有预装的库, 可以自己手动安装. 但麻烦的是, 如果你的notebook停用1小时以后, 远程的server就会停止, 然后你之前安装的东西就会被清除(数据和文件不会), 所以如果有额外的库, 就需要在每次打开的时候预先再次安装一遍.&lt;/p&gt;
&lt;p&gt;好在会有脚本可以做, 你可以参照这个&lt;a href="https://github.com/Microsoft/AzureNotebooks/issues/201#issuecomment-338466615"&gt;帖子&lt;/a&gt;&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;到你的 library &amp;gt; settings &amp;gt; Environment
选择 ShellScript 然后选择 特定的脚本
保存
重启 server
&lt;/pre&gt;


&lt;p&gt;安装pytorch的脚本&lt;a href="https://github.com/Microsoft/AzureNotebooks/files/1404777/script.txt"&gt;例子&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;export PATH=~/anaconda3_410/bin:$PATH
conda install pytorch torchvision -c soumith --yes
&lt;/pre&gt;


&lt;p&gt;安装其他的库, 只需要在anaconda里面搜索一下conda的安装方法, 然后替换上面脚本中的conda install pytorch那一段.&lt;/p&gt;
&lt;h3&gt;其他&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Mybinder
&lt;a href="https://mybinder.org/"&gt;https://mybinder.org/&lt;/a&gt;
这个我也还没用过, 据说可以从github里面直接导入, 生成一个docker. 需要什么库的话, 好像也可以通过脚本预先声明, 不一定像azure notebook那样要反复安装.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Google Colaboratory
&lt;a href="https://colab.research.google.com/"&gt;https://colab.research.google.com/&lt;/a&gt;
这是Google的jupyter服务, 但目前还没有完全开放, 点击注册以后会有"您已成功加入到候补名单。一旦 Colaboratory 可供您使用，我们会立即发送电子邮件通知您。"&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;在移动设备上使用&lt;/h2&gt;
&lt;p&gt;主流的手机/平板浏览器, 上面的服务都可以访问, 编辑的时候稍微有点别扭, 特别是在小屏幕的时候, 操作也还是不够方便, 但如果外接键盘/蓝牙键盘也还是不错的.&lt;/p&gt;
&lt;p&gt;除了内置的浏览器, 我还发现了专用的iOS app, &lt;a href="https://juno.sh/"&gt;Juno&lt;/a&gt; 目前还处于testflight状态, 可以去他家网页上申请beta测试. Juno中还内置了Mybinder的demo. 如果你购买了cocalc付费版, 也可以开放出一个远程的jupyter server供Juno使用.&lt;/p&gt;
&lt;h2&gt;自己建立Jupyter在线服务&lt;/h2&gt;
&lt;p&gt;开源社区现在越来越友好了, 有可能的话, 你也可以在自己的服务器或者VPS上建立一个在线的Jupyter服务, 为自己/学生/客户服务. 但我这么怕麻烦的人, 本地电脑都懒得装, 所以我都没有测试过.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Jupyter Hub: &lt;a href="https://github.com/jupyterhub/jupyterhub"&gt;https://github.com/jupyterhub/jupyterhub&lt;/a&gt; 这是jupyter官方的服务器安装程序.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Binder Hub:  &lt;a href="https://github.com/jupyterhub/binderhub"&gt;https://github.com/jupyterhub/binderhub&lt;/a&gt;也是从属与jupyter官方的, 但是用docker技术封装, 大概安装调试会方便一些吧.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Cocalc/sagemath: &lt;a href="https://github.com/sagemathinc/cocalc"&gt;https://github.com/sagemathinc/cocalc&lt;/a&gt; 这个也是用docker的, 还带有sagemath.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ps.
如果你在本地计算机上安装了jupyter, 非常推荐下面这个插件, 能够在保存jupyter文件的时候, 同时保存同名的 .html 和 .py 形式的文件. 这样在其他的python程序中导入自己写的函数会非常方便. 也很容易在github page上发布文档.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://protips.maxmasnick.com/ipython-notebooks-automatically-export-py-and-html"&gt;http://protips.maxmasnick.com/ipython-notebooks-automatically-export-py-and-html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;EOF()&lt;/p&gt;&lt;/div&gt;</description><category>python</category><category>现代眼科医生知识扩展包</category><guid>https://goldengrape.github.io/posts/python/na-xie-zai-xian-de-jupyter/</guid><pubDate>Sat, 18 May 2019 04:00:00 GMT</pubDate></item><item><title>根据字幕做视频摘要</title><link>https://goldengrape.github.io/posts/python/video_keynote/</link><dc:creator>Golden Grape</dc:creator><description>&lt;div&gt;&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;周末做了一个奇怪的小东西.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;I made a strange gadget on the weekend.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;一个根据字幕来做出视频缩略版的工具, 效果参见&lt;a href="https://www.youtube.com/watch?v=wxlySg9TBBI"&gt;李永乐老师讲柏拉图立体的复习缩略版&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;It is a tool to make a abbreviated video based on subtitles. See &lt;a href="https://www.youtube.com/watch?v=wxlySg9TBBI"&gt;Teacher Li Yongle explained the Platonic solid（review version)&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/wxlySg9TBBI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;这是一段remix的视频, 是从&lt;a href="https://www.youtube.com/watch?v=m9AE_G_9c7Y"&gt;李永乐老师讲柏拉图立体&lt;/a&gt; 的课程中节选了数学概念的部分, 去掉了推导与展开的部分. 原视频大约12分钟, 剪辑后的视频只有4分钟. 可以方便用来快速复习概念.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;This is a remix video, which is selected from the course of &lt;a href="https://www.youtube.com/watch?v=m9AE_G_9c7Y"&gt;Platonic solid&lt;/a&gt;, and the deduction and expansion part were removed. The original video is about 12 minutes, and the remix video is only 4 minutes. It is convenient for quick review of concepts.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!-- TEASER_END --&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;过程是这样的, 先从youtube下载某个视频的字幕, 然后你可以对字幕进行编辑, 删去不重要的部分, 只留下需要保留的文字, 但注意仍然要保留原来的换行. 然后程序会自动在字幕中查找保留文字, 并找到对应的时间. 把对应时间的视频片段下载下来, 连成一体.&lt;/p&gt;
&lt;p&gt;这个程序最好是在Google Colab上运行, 在本地电脑上运行要令终端也可以&lt;strong&gt;正常访问国际互联网&lt;/strong&gt; 本文的&lt;a href="https://github.com/goldengrape/goldengrape.github.io/blob/master/posts/python/video_keynote/index.ipynb"&gt;代码在github上&lt;/a&gt;, 可以上传至&lt;a href="https://colab.research.google.com/"&gt;google colab&lt;/a&gt;中运行&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;p&gt;The process follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;At first download the subtitles of a video from youtube, &lt;/li&gt;
&lt;li&gt;then you can edit the subtitles, delete the unimportant parts, leaving only the words that need to be retained, but note that you still need to keep the original line breaks. &lt;/li&gt;
&lt;li&gt;Then the program will Automatically find reserved text in the subtitles, and find the corresponding time. &lt;/li&gt;
&lt;li&gt;At last, the program will download the video clips corresponding to the time, and connect them together.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Recommend to run this program on Google Colab. &lt;a href="https://github.com/goldengrape/goldengrape.github.io/blob/master/posts/python/video_keynote/index.ipynb"&gt;The source code on github&lt;/a&gt;, which can be uploaded to &lt;a href="https://colab.research.google.com"&gt;google colab&lt;/a&gt; to run.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;这个程序依赖于&lt;a href="https://webvtt-py.readthedocs.io/en/latest/"&gt;webvtt-py&lt;/a&gt;、&lt;a href="https://rg3.github.io/youtube-dl/"&gt;youtube-dl&lt;/a&gt; 和 &lt;a href="https://ffmpeg.org/"&gt;ffmpeg&lt;/a&gt; , 当然还有&lt;a href="https://pandas.pydata.org/"&gt;pandas&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;注意在Google Colab上, webvtt-py和youtube-dl都是需要每次安装的.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;p&gt;This program requires &lt;a href="https://webvtt-py.readthedocs.io/en/latest/"&gt;webvtt-py&lt;/a&gt;, &lt;a href="https://rg3.github.io/youtube-dl/"&gt;youtube-dl&lt;/a&gt; and &lt;a href="https://ffmpeg.org/"&gt;ffmpeg&lt;/a&gt; and of course &lt;a href="https://pandas.pydata.org/"&gt;pandas&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Note that on Google Colab, both webvtt-py and youtube-dl need to be installed each time.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;webvtt&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="o"&gt;!&lt;/span&gt;pip install webvtt-py
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;webvtt&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;youtube_dl&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="o"&gt;!&lt;/span&gt;pip install youtube_dl
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;youtube_dl&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;subprocess&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;difflib&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="下载youtube视频字幕"&gt;下载youtube视频字幕&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#%E4%B8%8B%E8%BD%BDyoutube%E8%A7%86%E9%A2%91%E5%AD%97%E5%B9%95"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;首先是要下载youtube上的视频字幕, youtube的字幕有两类, 一是作者自己上传的文字字幕, 一是由youtube进行语音识别后生成的自动字幕, 其中自动字幕又会被机器翻译成各种语言.&lt;/p&gt;
&lt;p&gt;youtube字幕是一种叫做WebVTT的格式, 可以使用youtube-dl进行下载. 虽然youtube-dl有python运行方式, 但我还不能熟练掌握, 于是使用了subprocess.call运行命令行进行下载.&lt;/p&gt;
&lt;p&gt;如果是下载自动字幕, 要使用&lt;code&gt;--write-auto-sub&lt;/code&gt;, 如果是下载作者上传的字幕, 则是&lt;code&gt;--write-sub&lt;/code&gt;, 下载字幕的时候, 我觉得并不需要将视频也下载下来, 所以要使用&lt;code&gt;--skip-download&lt;/code&gt;, 字幕的语言简体中文=zh-Hans, 英文=en&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;h2 id="Download-youtube-video-subtitles"&gt;Download youtube video subtitles&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#Download-youtube-video-subtitles"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The first step is to download the video subtitles on youtube. There are two types of subtitles in youtube. One is uploaded by the author himself, and the other is automatic generated by speech recognition. The automatic subtitles are translated into various kinds by the machine learning.&lt;/p&gt;
&lt;p&gt;The format of youtube subtitle is WebVTT, which can be downloaded using youtube-dl. Although youtube-dl has python running mode, I still can't master it well. So I use subprocess.call to run the command to download.&lt;/p&gt;
&lt;p&gt;If you download automatic subtitles, use &lt;code&gt;--write-auto-sub&lt;/code&gt;. If you download the subtitles uploaded by the author, it is &lt;code&gt;--write-sub&lt;/code&gt;. When downloading subtitles, I don’t think I need to download the video, so adding &lt;code&gt;--skip-download&lt;/code&gt;. The language of the subtitles is choosing by "Language Tags", eg. simplified Chinese=zh-Hans, English=en&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;download_youtube_sub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;youtube_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;out_filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"zh-Hans"&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;vtt_command&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'youtube-dl'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
               &lt;span class="s1"&gt;'--write-auto-sub'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;# 如果下载作者自制的字幕则使用--write-sub&lt;/span&gt;
               &lt;span class="s1"&gt;'--sub-lang'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;# 选择语言&lt;/span&gt;
               &lt;span class="s1"&gt;'--skip-download'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# 不下载视频, 只下载字幕&lt;/span&gt;
               &lt;span class="s1"&gt;'--no-continue'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;    &lt;span class="c1"&gt;# 强制覆盖已经下载的文件&lt;/span&gt;
                   &lt;span class="n"&gt;youtube_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
              &lt;span class="s1"&gt;'--output'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;out_filename&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="c1"&gt;# 输出文件名格式&lt;/span&gt;
    &lt;span class="c1"&gt;# final out filename=out_filename+lang+'.vtt'&lt;/span&gt;
    &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;call&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vtt_command&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PIPE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stderr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;STDOUT&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"utf-8"&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="清理vtt字幕"&gt;清理vtt字幕&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#%E6%B8%85%E7%90%86vtt%E5%AD%97%E5%B9%95"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;vtt的字幕, 是一种还挺丰富(=复杂)的字幕格式, 里面不仅仅是时间戳和文字, 文字里可以加入丰富的特效.  特别是英文版本的vtt字幕, 为了表现出连贯的效果, 会把当前行与下一行字幕都显示出来, 于是每一句话其实记录了两次(中文似乎没有). 所以要进行一点清理. 将重复的部分删去. 只保留当前说的一句话, 和这句话的起止时间戳. 保存到一个pandas Dataframe里. 毕竟pandas后期好处理&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;h2 id="Clean-up-vtt-subtitles"&gt;Clean up vtt subtitles&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#Clean-up-vtt-subtitles"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;VTT subtitle is a kind of rich text (=complex) subtitle format, which is not only time stamps and texts, but also rich effects in the text. Especially the English version of vtt subtitles, the current line and the next line will be displayed, so each sentence is actually recorded twice (Chinese does not seem to). So cleaning up is need:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Delete the duplicated part, &lt;/li&gt;
&lt;li&gt;keep only the current one, and the start and end time of the sentence. &lt;/li&gt;
&lt;li&gt;Save to a pandas Dataframe. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;After all, pandas is easy to handle later.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clean_vtt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vtt&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;lines&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;starts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;ends&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;vtt&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;extend_text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;splitlines&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;repeat&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;extend_text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;lines&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;extend_text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;starts&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;repeat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;ends&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;repeat&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;previous&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
    &lt;span class="n"&gt;new_lines&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;new_starts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;new_ends&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lines&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;starts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;ends&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;previous&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;continue&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;new_lines&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;new_starts&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;new_ends&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;previous&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;

    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"start"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;new_starts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;"end"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;new_ends&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;"text"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;new_lines&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="合并vtt字幕成为脚本"&gt;合并vtt字幕成为脚本&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#%E5%90%88%E5%B9%B6vtt%E5%AD%97%E5%B9%95%E6%88%90%E4%B8%BA%E8%84%9A%E6%9C%AC"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;无他, 一行一句, 保留换行之后比较好看也好编辑.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;h2 id="merge-vtt-subtitles-into-scripts"&gt;merge vtt subtitles into scripts&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#merge-vtt-subtitles-into-scripts"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;One line one sentence. Keeping return \n is easier to read and edit.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;vtt_to_transcript&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vtt&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;clean_vtt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vtt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;transcript&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"text"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;transcript&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="在字幕中找到对应的句子"&gt;在字幕中找到对应的句子&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#%E5%9C%A8%E5%AD%97%E5%B9%95%E4%B8%AD%E6%89%BE%E5%88%B0%E5%AF%B9%E5%BA%94%E7%9A%84%E5%8F%A5%E5%AD%90"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;给定一句话, 要在字幕中找到这一句话的时间戳, 这样才能按照时间对视频切片. python的标准库里有一个difflib, 专门用来比较, 其中我使用的是get_close_matches, 找到最接近的文字. 这样即使只截取了一句话中的一部分, 也有可能找到相应的话语.&lt;/p&gt;
&lt;p&gt;考虑到给定的一句话, 一定是从字幕中提取出来, 所以没有考虑找不到的情况.&lt;/p&gt;
&lt;p&gt;使用pandas的优点在此显现, 只需要merge两个数据库, 就可以把相同字段, 相同内容的部分求出交集, 这样就可以获得时间戳了.&lt;/p&gt;
&lt;p&gt;(在这里记录url, 是为了日后扩展成从多个字幕中找句子, 那时就要记录每个字幕从哪里来的, 这是后话, 暂时还没有开始)&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;h2 id="Find-the-corresponding-sentence-in-the-subtitle"&gt;Find the corresponding sentence in the subtitle&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#Find-the-corresponding-sentence-in-the-subtitle"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Given a sentence, you need to find the timestamp of this sentence in the subtitles, so that you can slice the video according to the timestamp. There is a &lt;code&gt;difflib&lt;/code&gt; in the standard library of python, which is used for comparison. I use &lt;code&gt;get_close_matches&lt;/code&gt; to find the closest text. By this way, even if only a part of a sentence is choosen, it is possible to find the whole sentence.&lt;/p&gt;
&lt;p&gt;Consider a given sentence that must be extracted from the subtitles, so don't worry about not finding the given sentence.&lt;/p&gt;
&lt;p&gt;The advantages of using pandas appear here. You only need to merge two databases, then you can find the intersection of the same field and the same content, then you can get the timestamps.&lt;/p&gt;
&lt;p&gt;(The url is recorded here, in order to expand to find sentences from multiple subtitles in the future. At that time, it is necessary to record where each subtitle comes from. This is a future plan, but it has not yet started.)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;find_text_in_vtt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;vtt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;youtube_url&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;clean_vtt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vtt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"url"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;youtube_url&lt;/span&gt;
    &lt;span class="n"&gt;chosen_text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;splitlines&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="n"&gt;sentence&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;difflib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_close_matches&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"text"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sentence&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;chosen_text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sentence&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;df_chosen&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;chosen_text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"text"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;df_chosen&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;df_chosen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;merge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;df_chosen&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;以上就是处理字幕的部分.&lt;/p&gt;
&lt;p&gt;还是以李永乐老师讲课的视频为例, 这堂课的字幕内容&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;p&gt;The above is the part that handles subtitles.&lt;/p&gt;
&lt;p&gt;Take the video of Li Yongle’s lecture as an example. The subtitles of this lesson.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;"__main__"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;youtube_url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'https://www.youtube.com/watch?v=m9AE_G_9c7Y'&lt;/span&gt;
    &lt;span class="n"&gt;vtt_pre&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test"&lt;/span&gt;
    &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'zh-Hans'&lt;/span&gt;
    &lt;span class="n"&gt;vtt_filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'.'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;vtt_pre&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;"vtt"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;download_youtube_sub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;youtube_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;vtt_pre&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    
    &lt;span class="n"&gt;vtt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;webvtt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vtt_filename&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vtt_to_transcript&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;vtt&lt;/span&gt;&lt;span class="p"&gt;)[:&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;#blog中只显示100个字符&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;各位同学大家好 我是李永乐老师
最近有小朋友说 他看综艺节目里面谈到了
柏拉图立体和阿基米德多面体
他想问我这是什么
那我们今天就来先研究一下柏拉图立体
以前其实我们也曾经说过柏拉图立体
什么叫柏拉图
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="手工选择必要的关键部分"&gt;手工选择必要的关键部分&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#%E6%89%8B%E5%B7%A5%E9%80%89%E6%8B%A9%E5%BF%85%E8%A6%81%E7%9A%84%E5%85%B3%E9%94%AE%E9%83%A8%E5%88%86"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;对, 这个程序做不到人工智能, 只有手工智能, 我怎么知道你觉得那一部分更重要, 所以请复制粘贴上面打印出来的字幕, 然后删掉其中不想要的部分, 保留下需要的, 注意不要改变换行的方式.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;h2 id="Manually-select-the-key-parts"&gt;Manually select the key parts&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#Manually-select-the-key-parts"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Yep, this program can't do artificial intelligence, only manual intelligence. How do I know which part you think is more important? So please copy and paste the subtitles printed above, and then delete the unwanted parts, keep the key parts, be careful not to change the origional wrap.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;"__main__"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;keynote&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'''&lt;/span&gt;
&lt;span class="s1"&gt;什么叫柏拉图立体呢&lt;/span&gt;
&lt;span class="s1"&gt;他提出正多面体只有五种&lt;/span&gt;
&lt;span class="s1"&gt;所以我们就把正多面体称为柏拉图立体&lt;/span&gt;
&lt;span class="s1"&gt;首先它必须每一个面… 它是个正多面体&lt;/span&gt;
&lt;span class="s1"&gt;每个面都是同样的正多边形&lt;/span&gt;
&lt;span class="s1"&gt;除此之外 它还有一个要求&lt;/span&gt;
&lt;span class="s1"&gt;就是每个顶点的情况必须是相同的&lt;/span&gt;
&lt;span class="s1"&gt;比如说如果每一个顶点都连接三条棱&lt;/span&gt;
&lt;span class="s1"&gt;那所有顶点都必须是这样&lt;/span&gt;
&lt;span class="s1"&gt;然后你如果把这个图形稍微转一个方向&lt;/span&gt;
&lt;span class="s1"&gt;你会发现所有顶点都会跟以前重合&lt;/span&gt;
&lt;span class="s1"&gt;这个就叫每个顶点的情况是相同的&lt;/span&gt;
&lt;span class="s1"&gt;我们就把这种立体称之为正多面体&lt;/span&gt;
&lt;span class="s1"&gt;或者叫柏拉图立体&lt;/span&gt;
&lt;span class="s1"&gt;我们现在想证明一下 正多面体只有五种&lt;/span&gt;
&lt;span class="s1"&gt;首先我们先来看由正三角形所组成的&lt;/span&gt;
&lt;span class="s1"&gt;我们知道三角形每一个内角是60度&lt;/span&gt;
&lt;span class="s1"&gt;'''&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;然后我们就可以给出一句话的起止时间了:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Then we can get the start and end timestamps of a sentence:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;"__main__"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;find_text_in_vtt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;keynote&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;vtt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;youtube_url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;                 text           end         start  \
0           什么叫柏拉图立体呢  00:00:15.539  00:00:13.859   
1         他提出正多面体只有五种  00:00:24.339  00:00:21.719   
2   所以我们就把正多面体称为柏拉图立体  00:00:27.019  00:00:24.519   
3  首先它必须每一个面… 它是个正多面体  00:00:32.520  00:00:29.160   
4        每个面都是同样的正多边形  00:00:38.100  00:00:32.679   

                                           url  
0  https://www.youtube.com/watch?v=m9AE_G_9c7Y  
1  https://www.youtube.com/watch?v=m9AE_G_9c7Y  
2  https://www.youtube.com/watch?v=m9AE_G_9c7Y  
3  https://www.youtube.com/watch?v=m9AE_G_9c7Y  
4  https://www.youtube.com/watch?v=m9AE_G_9c7Y  
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="下载youtube片段"&gt;下载youtube片段&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#%E4%B8%8B%E8%BD%BDyoutube%E7%89%87%E6%AE%B5"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;根据上面获得的起止时间, 去下载youtube视频中的片段. 很遗憾, youtube-dl虽然可以方便下载youtube视频, 但却无法只下载某个片段. 所以这里有两个事情要做:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;获得真实的youtube视频文件地址. 真正的视频文件并不是你看到的www.youtube.com/watch?v=m9AE_G_9c7Y 而是一个带有签名的超复杂地址, 我猜测可能还会在不同电脑或者不同时间段有变化. 但YouTube-dl是能够获得这个地址的, 方便起见, 我直接抓取的是视频+音频合并的格式. 此时也不必下载视频.&lt;/li&gt;
&lt;li&gt;通过ffmpeg下载视频片段, ffmpeg的&lt;code&gt;-ss -to&lt;/code&gt;可以设定起止时间, 但如果直接使用起止时间, 应当用&lt;code&gt;-copyts&lt;/code&gt;来强制使用原始视频的绝对时间. 而且&lt;code&gt;-ss&lt;/code&gt;放在&lt;code&gt;-i&lt;/code&gt;之前还是之后,也有不少学问. 具体请参考&lt;a href="https://trac.ffmpeg.org/wiki/Seeking"&gt;https://trac.ffmpeg.org/wiki/Seeking&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这里使用了x264和mp3分别对视频和音频进行了重新编码, 导致速度较慢. 理论上可以使用“copy”, 但实测发现因为每个片段都很短, 高概率丢失关键帧, 所以不重新编码的话, 很有可能画面是静止的.&lt;/p&gt;
&lt;p&gt;虽然ffmpeg也有python的处理版本, 但是那个库也是生成了ffmpeg的命令行, 还要学一堆他自定的语法, 还不如我直接用subprocess.run呢&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;h2 id="Download-youtube-clip"&gt;Download youtube clip&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#Download-youtube-clip"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;According to the start and end timestamps obtained above, you can download the clip in the youtube video. Unfortunately, although youtube-dl can download youtube videos conveniently, it can't just download a clip. So there are two things to do here:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Get the real youtube video file address. The real video file is not what you see as www.youtube.com/watch?v=m9AE_G_9c7Y but a super complex address with a signature, I guess it might change on a different computer or in different time periods. But YouTube-dl is able to get this address. For convenience, I will directly capture the video + audio merged format. There is no need to download the video at this time.&lt;/li&gt;
&lt;li&gt;Download video clips via ffmpeg, ffmpeg's &lt;code&gt;-ss -to&lt;/code&gt; can set the start and end time, but if you use the start and end time directly, you should use &lt;code&gt;-copyts&lt;/code&gt; to force the absolute time of the original video. And &lt;code&gt;-ss&lt;/code&gt; Before or after &lt;code&gt;-i&lt;/code&gt;, there are also many studies. For details, please refer to &lt;a href="https://trac.ffmpeg.org/wiki/Seeking"&gt;https://trac.ffmpeg.org/wiki/Seeking&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Here, x264 and mp3 are used to re-encode video and audio respectively, but resulting a slower speed. In theory, "copy" can be used, but I find out that because each fragment is short and the key frame is lost with high probability, it cannot re-encoded well. If so, it is very likely that the picture is still.&lt;/p&gt;
&lt;p&gt;Although ffmpeg also has a python processing version, but that library is also generates the ffmpeg command, and I need to learn a bunch of custom syntax. So I prefer &lt;code&gt;subprocess.run&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [15]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;download_part_youtube&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;video_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;output_filename&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;youtube_dl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;YoutubeDL&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;'format'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'22'&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;ydl&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;info_dict&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ydl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extract_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;video_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;download&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;real_video_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;info_dict&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"url"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;ffmpeg_command&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'ffmpeg'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="s1"&gt;'-ss'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="s1"&gt;'-i'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="n"&gt;real_video_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="s1"&gt;'-to'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="s1"&gt;'-c:v'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'libx264'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'-c:a'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'libmp3lame'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;#视频重编码使用x264, 音频重编码使用mp3&lt;/span&gt;
     &lt;span class="s1"&gt;'-copyts'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;# 强制使用原视频的绝对时间&lt;/span&gt;
     &lt;span class="s1"&gt;'-y'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;# 强制覆盖&lt;/span&gt;
     &lt;span class="n"&gt;output_filename&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ffmpeg_command&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PIPE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stderr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;STDOUT&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"utf-8"&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="根据文字截取视频片段并合并"&gt;根据文字截取视频片段并合并&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#%E6%A0%B9%E6%8D%AE%E6%96%87%E5%AD%97%E6%88%AA%E5%8F%96%E8%A7%86%E9%A2%91%E7%89%87%E6%AE%B5%E5%B9%B6%E5%90%88%E5%B9%B6"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;这就是把前面的准备工作合并到一起了, 根据摘取的数据库中的url、起止时间, 去到每个url中下载起止时间的视频片段. 这些视频片段都下载到了本地, 将文件名写入一个txt文件进行记录. 然后使用ffmpeg的concat功能将txt文件中的文件合并成一个视频文件. 最后再打扫一下临时文件, 就大功告成了.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;h2 id="Capture-video-clips-based-on-text-and-merge"&gt;Capture video clips based on text and merge&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#Capture-video-clips-based-on-text-and-merge"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;This is to merge the previous preparations together. According to the url in the extracted database, the start and end time, go to each url to download the video clips from the start to end time. These video clips are downloaded, the file name is record to a txt file. Then use ffmpeg's concat function to merge the files in the txt file into one video file. Finally, clean the temporary file and you're done.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [16]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_youtube_by_keynote&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;final_output&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;#临时文件命名, 记录临时文件列表&lt;/span&gt;
    &lt;span class="n"&gt;temp_file_list&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"tmp_&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt;.mp4"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;))]&lt;/span&gt;
    &lt;span class="n"&gt;temp_input&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'tmp_input_files.txt'&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;temp_input&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'w'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
            &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"file '&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;temp_file_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;    

    
    &lt;span class="c1"&gt;# 遍历数据库, 下载每个视频片段&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iterrows&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="n"&gt;download_part_youtube&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;temp_file_list&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    
    &lt;span class="c1"&gt;# 将临时文件合并起来&lt;/span&gt;
    &lt;span class="n"&gt;ff_concat_command&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"ffmpeg"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
                   &lt;span class="s1"&gt;'-f'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'concat'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                   &lt;span class="s1"&gt;'-safe'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;'0'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                   &lt;span class="s1"&gt;'-i'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;temp_input&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                   &lt;span class="s1"&gt;'-c:v'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'copy'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'-c:a'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'copy'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'-copyts'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="c1"&gt;#合并似乎不需要重新编码&lt;/span&gt;
                   &lt;span class="s1"&gt;'-y'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                   &lt;span class="n"&gt;final_output&lt;/span&gt;
                   &lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ff_concat_command&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# 打扫临时文件&lt;/span&gt;
    &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;temp_input&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;temp_file_list&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;合并到一起, 如果是在本地运行, 只需要找本地目录中的内容. 如果是放在colab上, 下载文件是要调用google.colab库中的file.download函数&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;p&gt;Merge together. If it run locally, just look for the contents of the local directory. If it is placed on the colab, to download file is to call the file.download function in the google.colab library.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;"__main__"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;find_text_in_vtt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;keynote&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;vtt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;youtube_url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;final_output&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"final.mp4"&lt;/span&gt;
    &lt;span class="n"&gt;get_youtube_by_keynote&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;final_output&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    
    &lt;span class="c1"&gt;# download from google colab&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;google.colab&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;files&lt;/span&gt;
        &lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;download&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;final_output&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"not in google colab"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="使用与进一步改进"&gt;使用与进一步改进&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#%E4%BD%BF%E7%94%A8%E4%B8%8E%E8%BF%9B%E4%B8%80%E6%AD%A5%E6%94%B9%E8%BF%9B"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;这个小工具可以用来制作公开课的快速复习视频. 比如OCW, deeplearning.ai中的课程, 都是放在youtube上的. 一些上过的课时间一久就该忘了, 太可惜了. 但完全重看一遍又没有必要, 如果用此方法可以制作出快速复习视频. 只需要很短的时间就可以唤起回忆.&lt;/p&gt;
&lt;p&gt;另一个可能的诡异应用是, 我也可以不视频字幕中的文字, 而是自己撰写一些常用的语句, 如果difflib.get_close_matches能够找到接近的语句, 就可以摘取下来. 那么给定一组视频, 比如某个总统的演讲视频. 也可以制作出一份“断章取义”的视频来. 当然每句话之间是断断续续, 背景也可能不断转换. 但可能很有趣吧. 这个功能需要对查找的部分进行一些修改, 以后有时间再进行了.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;blockquote&gt;&lt;h2 id="Use-and-further-improvement"&gt;Use and further improvement&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/video_keynote/#Use-and-further-improvement"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;This gadget can be used to make quick review videos of open classes. For example, the courses in OCW, deeplearning.ai are all on youtube. Some of the lessons have been forgotten for a long time, it is a pity. But it's not necessary to review it completely again. If you use this gadget, you can make a short review video. It only takes a short time to evoke memories.&lt;/p&gt;
&lt;p&gt;Another possible weird application is that I can also write some common sentences NOT in the video subtitles. If &lt;code&gt;difflib.get_close_matches&lt;/code&gt; can find the close statement, it can be extracted. Then given a set of videos, For example, a video of a president's speech. You can also make a video that is “out of context”. Of course, every sentence is intermittent, and the background may be constantly changing. But it may be interesting. Some modifications needs to be performed on the searched part.  Might do it later.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>python</category><guid>https://goldengrape.github.io/posts/python/video_keynote/</guid><pubDate>Mon, 25 Mar 2019 04:00:00 GMT</pubDate></item><item><title>通项公式快速求解</title><link>https://goldengrape.github.io/posts/python/carefree-princess-1018/</link><dc:creator>Golden Grape</dc:creator><description>&lt;div tabindex="-1" id="notebook" class="border-box-sizing"&gt;
    &lt;div class="container" id="notebook-container"&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;现在每天早上早起, 先做一道&lt;a href="https://mp.weixin.qq.com/s/kyWUQoWPPokr4ITg4G3fwA"&gt;无忧公主的数学时间&lt;/a&gt;里面的数学题, 提神醒脑.&lt;/p&gt;
&lt;p&gt;今天的题目是这样的:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;f(1)=f(2)=1&lt;/p&gt;
&lt;p&gt;f(n)=f(n-1)-f(n-2)+n&lt;/p&gt;
&lt;p&gt;求f(2018)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;解法大概是找规律什么的吧, 中间会出现f(n-1)=f(n-2)的情况, 然后有一定的循环.&lt;/p&gt;
&lt;p&gt;但是, 怎么能这么轻易使用自己手算呢? 一定要暴力编程解决才好.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;随手写个递归:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;
&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;1 1
2 1
3 3
4 6
5 8
6 8
7 7
8 7
9 9
10 12
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;但没有使用尾递归的话, 计算f(2018)肯定是要死机的. 然后, 我&lt;strong&gt;忘记怎么写尾递归了&lt;/strong&gt;
&lt;!-- TEASER_END --&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;第二招, 母函数&lt;/p&gt;
&lt;p&gt;要用上母函数, 里面不能有个n这样的变量. 应该消掉. 所以把f(n-1)=f(n-2)-f(n-3)+n-1代入,&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;f(n)=f(n-2)-f(n-3)+n-1 -f(n-2)+n
f(n)=-f(n-3)+2n-1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;再消掉n, 得到:
$$
f(n)=2 f(n-1)-2 f(n-2)+f(n-3)+1
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;然后, 我忘记母函数如何展开了, 要用泰勒展开之类的.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;还有第三招, 矩阵乘法&lt;/p&gt;
&lt;p&gt;把f(n)写成一个矩阵M去乘与f(n-1)向量的形式, 然后最终就成了计算M的n次方. 当然, 我又不记得矩阵乘方的运算了, 似乎是进行特征分解. 不过呢, 反正numpy在算矩阵乘法的时候是经过优化的, 速度很快.&lt;/p&gt;
&lt;p&gt;目的是写出一个简单的矩阵M, 满足下面的式子&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;$$
\begin{bmatrix}
  f(n) 
  \\f(n-1)
  \\f(n-2)
  \\n+1
  \\1
\end{bmatrix}=
M
\begin{bmatrix}
  f(n-1) 
  \\f(n-2)
  \\f(n-3)
  \\n
  \\1
\end{bmatrix}
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;根据条件, 很好写:
$$
\begin{bmatrix}
  f(n) 
  \\f(n-1)
  \\f(n-2)
  \\n+1
  \\1
\end{bmatrix}=
\begin{bmatrix}
    1,-1,0, 1,0 
  \\1,0, 0,0,0
  \\0,1, 0,0,0
  \\0,0,0,1,1
  \\0,0,0,0,1
\end{bmatrix}
\begin{bmatrix}
  f(n-1) 
  \\f(n-2)
  \\f(n-3)
  \\n
  \\1
\end{bmatrix}
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;所以程序就很容易写出来了:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;numpy.linalg&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="n"&gt;matrix_power&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;f_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;f3&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;asarray&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;matmul&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;matrix_power&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;f3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;%%&lt;/span&gt;&lt;span class="k"&gt;timeit&lt;/span&gt; 
f_matrix(2018)
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;66 µs ± 859 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2018&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;2017
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;以上方法适用于类似我这样知识点只记得住开头的水平, 即使没有能够记住完整的部分, 也可以利用矩阵乘法在程序内置计算够快的feature来求解. 万一以后做什么面试题, 也许会用上吧&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
</description><category>python</category><guid>https://goldengrape.github.io/posts/python/carefree-princess-1018/</guid><pubDate>Tue, 08 Jan 2019 08:00:00 GMT</pubDate></item><item><title>Alpha的后验分解</title><link>https://goldengrape.github.io/posts/python/Alpha_tear/</link><dc:creator>Golden Grape</dc:creator><description>&lt;div tabindex="-1" id="notebook" class="border-box-sizing"&gt;
    &lt;div class="container" id="notebook-container"&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Alpha的后验分解"&gt;Alpha的后验分解&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#Alpha%E7%9A%84%E5%90%8E%E9%AA%8C%E5%88%86%E8%A7%A3"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;最近在学习量化分析, 其中有一个作业是这样:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Alpha的后验分解：给定一个组合P，估算该组合相对于业绩基准组合B的各参数：$β_p$ 、$α_p$、 以及组合风险 $σ_p$ 和残差风险 $ω_p$&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;总觉得自己哪里算错了, 比如&lt;a href="http://cn.morningstar.com/quicktake/F0000003X3"&gt;华夏上证50ETF(代码: 510050)&lt;/a&gt;的alpha算出来总是-0.00091,&lt;/p&gt;
&lt;p&gt;一时检查不出来, 暂时先摆出来供讨论
&lt;!-- TEASER_END --&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;tushare&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;ts&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="设定目标"&gt;设定目标&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E8%AE%BE%E5%AE%9A%E7%9B%AE%E6%A0%87"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"510050.XSHG"&lt;/span&gt; &lt;span class="c1"&gt;# 华夏上证50&lt;/span&gt;
&lt;span class="n"&gt;benchmark&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"000300.XSHG"&lt;/span&gt; &lt;span class="c1"&gt;# 沪深300指数&lt;/span&gt;
&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"2015-1-1"&lt;/span&gt;
&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"2018-9-1"&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="获得历史价格"&gt;获得历史价格&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E8%8E%B7%E5%BE%97%E5%8E%86%E5%8F%B2%E4%BB%B7%E6%A0%BC"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 如果有基金净值数据, 不能使用get_price取得, 因此分别提取数据&lt;/span&gt;
&lt;span class="n"&gt;p_target&lt;/span&gt;   &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;get_price&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;   &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;start_date&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_date&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"close"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;p_benchmark&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;get_price&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;benchmark&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;start_date&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_date&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"close"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 为避免投资组合的净值(价格)采样时间与基准的采样时间不同, 取两者的交集&lt;/span&gt;
&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;p_target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p_benchmark&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'inner'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;benchmark&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# 通过ts获取基金净值的时间顺序, 与通过ts获取股票价格的时间顺序, 这两者可能不同, 因此统一到时间降序上&lt;/span&gt;
&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ascending&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;inplace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[4]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;510050.XSHG&lt;/th&gt;
      &lt;th&gt;000300.XSHG&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;date&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-31&lt;/th&gt;
      &lt;td&gt;2.521&lt;/td&gt;
      &lt;td&gt;3334.5036&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-30&lt;/th&gt;
      &lt;td&gt;2.533&lt;/td&gt;
      &lt;td&gt;3351.0942&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-29&lt;/th&gt;
      &lt;td&gt;2.553&lt;/td&gt;
      &lt;td&gt;3386.5736&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-28&lt;/th&gt;
      &lt;td&gt;2.560&lt;/td&gt;
      &lt;td&gt;3400.1705&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-27&lt;/th&gt;
      &lt;td&gt;2.571&lt;/td&gt;
      &lt;td&gt;3406.5735&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# 前一个交易日价格&lt;/span&gt;
&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shift&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[5]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;510050.XSHG&lt;/th&gt;
      &lt;th&gt;000300.XSHG&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;date&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-31&lt;/th&gt;
      &lt;td&gt;2.533&lt;/td&gt;
      &lt;td&gt;3351.0942&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-30&lt;/th&gt;
      &lt;td&gt;2.553&lt;/td&gt;
      &lt;td&gt;3386.5736&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-29&lt;/th&gt;
      &lt;td&gt;2.560&lt;/td&gt;
      &lt;td&gt;3400.1705&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-28&lt;/th&gt;
      &lt;td&gt;2.571&lt;/td&gt;
      &lt;td&gt;3406.5735&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-27&lt;/th&gt;
      &lt;td&gt;2.523&lt;/td&gt;
      &lt;td&gt;3325.3347&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="计算收益率"&gt;计算收益率&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E8%AE%A1%E7%AE%97%E6%94%B6%E7%9B%8A%E7%8E%87"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;每日收益率: 通过投资组合权益计算出的日收益率。&lt;/p&gt;
&lt;p&gt;$$
每日收益率=\frac{当前交易日总权益-前一交易日总权益}{前一交易日总权益}
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shift&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;price&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shift&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;inplace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# last row is NaN, I think it should be droped&lt;/span&gt;
&lt;span class="c1"&gt;# 取得中债国债收益率曲线作为无风险收益率&lt;/span&gt;
&lt;span class="n"&gt;r_riskfree&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;get_yield_curve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;start_date&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end_date&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tenor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'0S'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;merge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r_riskfree&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;left_index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;right_index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;how&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"inner"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;benchmark&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"riskfree"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[6]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;510050.XSHG&lt;/th&gt;
      &lt;th&gt;000300.XSHG&lt;/th&gt;
      &lt;th&gt;riskfree&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-31&lt;/th&gt;
      &lt;td&gt;-0.004737&lt;/td&gt;
      &lt;td&gt;-0.004951&lt;/td&gt;
      &lt;td&gt;0.018291&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-30&lt;/th&gt;
      &lt;td&gt;-0.007834&lt;/td&gt;
      &lt;td&gt;-0.010476&lt;/td&gt;
      &lt;td&gt;0.017971&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-29&lt;/th&gt;
      &lt;td&gt;-0.002734&lt;/td&gt;
      &lt;td&gt;-0.003999&lt;/td&gt;
      &lt;td&gt;0.019096&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-28&lt;/th&gt;
      &lt;td&gt;-0.004278&lt;/td&gt;
      &lt;td&gt;-0.001880&lt;/td&gt;
      &lt;td&gt;0.018622&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2018-08-27&lt;/th&gt;
      &lt;td&gt;0.019025&lt;/td&gt;
      &lt;td&gt;0.024430&lt;/td&gt;
      &lt;td&gt;0.018767&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="计算$\beta$"&gt;计算$\beta$&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E8%AE%A1%E7%AE%97%24%5Cbeta%24"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;计算方法参考&lt;a href="https://www.ricequant.com/api/python/chn#backtest-results-factors"&gt;RiceQuant API文档&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;贝塔(beta, $\beta$ ): &lt;a href="https://en.wikipedia.org/wiki/Capital_asset_pricing_model"&gt;CAPM&lt;/a&gt;模型中市场基准组合项的系数，表示资产收益对市场整体收益波动的敏感程度。
 $$
 \beta=\frac{Cov(r_{p,e}, r_{b,e})}{Var(r_{b,e})}
 $$&lt;/p&gt;
&lt;p&gt;其中$r_{p,e}$为策略超额收益率（策略收益率 - 无风险组合收益率）；$r_{b,e}$为市场基准组合超额收益率（市场基准组合收益率 - 无风险组合收益率）；Cov 表示协方差；Var 表示方差&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;注意: numpy中, np.cov(a,b)的计算结果是$2\times2$矩阵
$$
np.cov(a,b)=\left[ \begin{array}{cc} cov\left( a,\; a \right) &amp;amp; cov\left( a,\; b \right) \\ cov\left( a,\; b \right) &amp;amp; cov\left( b,\; b \right) \end{array} \right]
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;r_pe&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"riskfree"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;r_be&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;benchmark&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"riskfree"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cov&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_pe&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r_be&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_be&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;beta&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[7]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;0.9511718021320907&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="求解$\alpha$"&gt;求解$\alpha$&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E6%B1%82%E8%A7%A3%24%5Calpha%24"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;h3 id="方法1"&gt;方法1&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E6%96%B9%E6%B3%951"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;计算方法参考&lt;a href="https://www.ricequant.com/api/python/chn#backtest-results-factors"&gt;RiceQuant API文档&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;阿尔法(alpha, $\alpha$): &lt;a href="https://en.wikipedia.org/wiki/Capital_asset_pricing_model"&gt;CAPM&lt;/a&gt;模型表达式中的残余项。表示策略所持有投资组合的收益中和市场整体收益无关的部分，是策略选股能力的度量。当策略所选股票的总体表现优于市场基准组合成分股时，阿尔法取正值；反之取负值。
$$
\alpha=E[r_p-[r_f+\beta \times (r_b-r_f)]]
$$&lt;/p&gt;
&lt;p&gt;其中$r_p$为策略所持有投资组合收益；$r_f$为无风险组合收益；$\beta$为CAPM模型中的贝塔系数；E表示随机变量的期望。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"riskfree"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;benchmark&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"riskfree"&lt;/span&gt;&lt;span class="p"&gt;])))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;alpha&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[8]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;-0.00091193563738157&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="方法2"&gt;方法2&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E6%96%B9%E6%B3%952"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;$$
\theta_p(t)= \alpha_p+ \epsilon(t)
\\
E[r_p(t)] = \beta_p E[r_B(t)] + E[\theta_p(t)]
\\
\alpha_p=E[\theta_p(t)]
\\
\alpha_p=E[r_p(t)]-\beta_p E[r_B(t)]
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_pe&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;r_be&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[9]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;-0.0009119356373815703&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="求解投资组合风险-$\sigma_p$"&gt;求解投资组合风险 $\sigma_p$&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E6%B1%82%E8%A7%A3%E6%8A%95%E8%B5%84%E7%BB%84%E5%90%88%E9%A3%8E%E9%99%A9-%24%5Csigma_p%24"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sigma_p&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;sigma_p&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[10]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;0.01640696817905404&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="求解残差风险-$\omega_p$"&gt;求解残差风险 $\omega_p$&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E6%B1%82%E8%A7%A3%E6%AE%8B%E5%B7%AE%E9%A3%8E%E9%99%A9-%24%5Comega_p%24"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;$$
\omega _{p}=\; \sqrt{\sigma _{p}^{2}-\beta _{p}^{2}\cdot \sigma _{B}^{2}\; }
$$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;omega_p&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sigma_p&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;beta&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;benchmark&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;omega_p&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[11]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;0.005885928156058898&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="年化"&gt;年化&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E5%B9%B4%E5%8C%96"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;这里假设一年有244个交易日。&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;day_count&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;get_trading_dates&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;start_date&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;end_date&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;annual_correct&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;244&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;day_count&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;annual_sigma_p&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;annual_correct&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sigma_p&lt;/span&gt;
&lt;span class="n"&gt;annual_omega_p&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;annual_correct&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;omega_p&lt;/span&gt;
&lt;span class="n"&gt;annual_sigma_p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;omega_p&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[12]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;(0.008566663958171634, 0.005885928156058898)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="RiceQuant上其他一些指标"&gt;RiceQuant上其他一些指标&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#RiceQuant%E4%B8%8A%E5%85%B6%E4%BB%96%E4%B8%80%E4%BA%9B%E6%8C%87%E6%A0%87"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="年化波动率(volatility,-$\sigma_t$):"&gt;年化波动率(volatility, $\sigma_t$):&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E5%B9%B4%E5%8C%96%E6%B3%A2%E5%8A%A8%E7%8E%87(volatility,-%24%5Csigma_t%24):"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;blockquote&gt;&lt;p&gt;策略收益率的标准差，最常用的风险度量。波动率越大，策略承担的风险越高。这里假设一年有244个交易日。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$$
\sigma =\sqrt{\frac{244}{n-1}\sum_{i=1}^{n}{\left[ r_{p}\left( i \right)\; -\; \bar{r_{p}} \right]^{2}}}
$$&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;其中，n为回测期内交易日数目；$r_p(i)$ 表示第 i 个交易日策略所持有投资组合的日收益率；$ \bar{r_p} $ 为回测期内策略日收益率的均值。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;volatility&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;244&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;day_count&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;# 定义与年化投资组合风险sigma_p一致&lt;/span&gt;
&lt;span class="n"&gt;volatility&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[13]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;0.008566663958171633&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="年化跟踪误差(tracking-error,$\sigma_t$-):"&gt;年化跟踪误差(tracking error,$\sigma_t$ ):&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E5%B9%B4%E5%8C%96%E8%B7%9F%E8%B8%AA%E8%AF%AF%E5%B7%AE(tracking-error,%24%5Csigma_t%24-):"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;blockquote&gt;&lt;p&gt;纯多头主动交易策略（阿尔法策略和基准择时策略）收益和市场基准组合收益之间差异的度量。跟踪误差越大，意味着策略所持有投资组合偏离基准组合的程度越大。需要注意，跟踪误差不适用于多-空结合的对冲策略的风险评估&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$$
\sigma =\sqrt{\frac{244}{n-1}\sum_{i=1}^{n}{\left[ r_{pa}\left( i \right)\; -\; \bar{r_{pa}} \right]^{2}}}
\\
r_{pa}(i)=r_p(i)-r_b(i)
$$
其中，n为回测期内交易日数量；$r_{pa}(i), r_p(i), r_b(i)$分别表示第i个交易日策略所持有投资组合的日主动收益、日收益率和基准组合的日收益率。&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;tracking_error&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;244&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;day_count&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r_pe&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="n"&gt;tracking_error&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[14]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;0.5218443423891064&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="年化下行波动率(downside-risk,-$\sigma_d$):"&gt;年化下行波动率(downside risk, $\sigma_d$):&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E5%B9%B4%E5%8C%96%E4%B8%8B%E8%A1%8C%E6%B3%A2%E5%8A%A8%E7%8E%87(downside-risk,-%24%5Csigma_d%24):"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;blockquote&gt;&lt;p&gt;相比波动率，下行波动率对收益向下波动和向上波动两种情况做出了区分，并认为只有收益向下波动才意味着风险。在实际计算中，我们统一使用基准组合收益为目标收益，作为向上波动和向下波动的判断标准。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$$
\sigma =\sqrt{\frac{244}{n-1}\sum_{i=1}^{n}{\left[ r_{p}\left( i \right)\; -\; r_{b}(i) \right]^{2} I(i)}}
$$
$$
I(i)=\begin{cases}1 &amp;amp; r_p(i)&amp;lt;r_b(i) \\ 0 &amp;amp; r_p(i) \geq r_b(i)\end{cases}
$$&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;其中，n为回测期内交易日数量；$r_p,r_b$ 分别表示第i个交易日策略所持有投资组合的日收益率、基准组合的日收益率；I(i)为指示函数(indicator function)，如果第i个交易日策略所持有投资组合收益低于基准组合收益，则标记为1（向下波动），否则标记为0（向上波动）。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [15]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;downside_r&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;benchmark&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dropna&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;downside_risk&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;244&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;day_count&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;downside_r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;downside_r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;benchmark&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;downside_risk&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[15]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;0.06079720493473829&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="最大回撤(max-drawdown):"&gt;最大回撤(max drawdown):&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/Alpha_tear/#%E6%9C%80%E5%A4%A7%E5%9B%9E%E6%92%A4(max-drawdown):"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;blockquote&gt;&lt;p&gt;在回测期内，在任一交易日往后推，策略总权益走到最低点时收益率回撤幅度的最大值。最大回撤是评估策略极端风险管理能力的重要指标。其计算方式如下：
$$
Drawdown_t=\begin{cases}0 &amp;amp; NET_t = min_{j \geq t} NET_j\\\frac{NET_t-min_{j \geq t}NET_j}{NET_t} &amp;amp; ELSE\end{cases}
\\
NET=某期净值
\\
MaxDrawdown=Max(Drawdown_t)
$$&lt;/p&gt;
&lt;/blockquote&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [16]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;p_target&lt;/span&gt;
&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ascending&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;inplace&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;NET_min&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;NET_min&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;min&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;Drawdown_t&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;NET_min&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;NET&lt;/span&gt;
&lt;span class="n"&gt;max_Drawdown&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Drawdown_t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;max_Drawdown_date&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Drawdown_t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;idxmax&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_Drawdown_date&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_Drawdown&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

&lt;div class="prompt output_prompt"&gt;Out[16]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;(Timestamp('2015-06-08 00:00:00'), 0.44965219768536796)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
</description><category>python</category><guid>https://goldengrape.github.io/posts/python/Alpha_tear/</guid><pubDate>Sat, 22 Sep 2018 17:00:00 GMT</pubDate></item><item><title>octopus视野报告数据提取</title><link>https://goldengrape.github.io/posts/python/octopus-data/</link><dc:creator>Golden Grape</dc:creator><description>&lt;div&gt;&lt;p&gt;又写好了一段PDF报告数据提取的小程序, 这次是针对Octopus 900动态视野计的. 可以提取PDF的视野检查结果报告中的数据, 能够提取的数据包括: 姓名, 生日, 检查日期, 眼别, 检查程序名称, RF, MS, MD, sLV, 还有视野测量的原始数据. &lt;/p&gt;
&lt;p&gt;提取出来的数据保存在csv文件里, 可以使用excel打开和处理.
&lt;img alt="示例" src="https://i.loli.net/2018/07/09/5b43624ad0d9f.png"&gt;
其中以G standard程序测量的原始数据是按照从中心开始顺时针螺线的方式排列成一行的.
&lt;img alt="屏幕快照 2018-07-08 20.11.26" src="https://i.loli.net/2018/07/09/5b437a3ac6eed.png"&gt;&lt;/p&gt;
&lt;p&gt;也可以处理一个一个文件夹下所有的PDF报告, 把提取的数据汇总到一个csv里面.&lt;/p&gt;
&lt;p&gt;项目文件开源, 放在在&lt;a href="https://github.com/goldengrape/read_medical_device_data/blob/master/python/pdf_parser/Octopus_VF.ipynb"&gt;github&lt;/a&gt;上, 如果已经比较熟悉github, python和jupyter, 打开看看就很容易理解.  &lt;/p&gt;
&lt;p&gt;&lt;em&gt;注意: 目前我还只能处理未加密的PDF, 并且PDF的页面大小必须严格是A4, 否则无法取得数据. 切记切记.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;但如果以前没怎么接触过python, 又临时需要处理些数据, 那么以下是使用教程:
&lt;!-- TEASER_END --&gt;&lt;/p&gt;
&lt;h2&gt;云端运行&lt;/h2&gt;
&lt;p&gt;如果不是写python已经比较熟练的人, 我一般不推荐在本地计算机上安装python和相关的工具包, 很容易出错. 我建议是在云端运行, 可以选择的服务商很多, 但微软的 &lt;a href="https://notebooks.azure.com"&gt;Azure notebook&lt;/a&gt; 免费, 国内可以访问, 还可以运行私有项目以免泄露病人数据, 因此比较推荐.&lt;/p&gt;
&lt;p&gt;1.
打开微软的&lt;a href="https://notebooks.azure.com"&gt;Azure notebook&lt;/a&gt;, 地址是https://notebooks.azure.com , 点击页面右上的Sign In, 使用微软账户登陆, 如果没有微软账户的话, 需要自己注册一个.&lt;/p&gt;
&lt;p&gt;&lt;img alt="屏幕快照 2018-07-09 21.34.01" src="https://i.loli.net/2018/07/09/5b4364976e694.png"&gt;&lt;/p&gt;
&lt;p&gt;2.
登陆进来以后, 点击左上的Libraries, 将列出您已经建立过的Library, 如果以前没用过, 下面是空的.
&lt;img alt="屏幕快照 2018-07-09 21.36.27" src="https://i.loli.net/2018/07/09/5b43652cc37a4.png"&gt;&lt;/p&gt;
&lt;p&gt;3.
点击 + New Library, 建立一个新的Library.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在选项卡中, 选择From GitHub,&lt;/li&gt;
&lt;li&gt;在GitHub repository里面填上https://github.com/goldengrape/read_medical_device_data&lt;/li&gt;
&lt;li&gt;给自己的Library起个名字, 再起个ID, 比如都叫Octopus&lt;/li&gt;
&lt;li&gt;然后点击Import&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="屏幕快照 2018-07-09 21.40.09" src="https://i.loli.net/2018/07/09/5b4365d3b854f.png"&gt;&lt;/p&gt;
&lt;p&gt;4.
稍等, 或者刷新一下页面, 你会看到刚才建立的Library已经出现了, 点击进入.&lt;/p&gt;
&lt;h2&gt;上传数据&lt;/h2&gt;
&lt;p&gt;1.
在上传数据之前, 先把这个Library设定成私有,
&lt;img alt="屏幕快照 2018-07-09 21.46.04" src="https://i.loli.net/2018/07/09/5b4367339bc4b.png"&gt;
点击齿轮⚙️图标&lt;/p&gt;
&lt;p&gt;把Public Library前面的钩去掉, 然后Save
&lt;img alt="屏幕快照 2018-07-09 21.47.41" src="https://i.loli.net/2018/07/09/5b43679c89bac.png"&gt;&lt;/p&gt;
&lt;p&gt;2.
点击加号➕图标, 就在刚才的齿轮⚙️左边.
&lt;img alt="屏幕快照 2018-07-09 21.50.40" src="https://i.loli.net/2018/07/09/5b4368753d62d.png"&gt;
在item type里面选上Folder, 给自己的数据文件夹起个名字, 比如testdata, 然后点击New&lt;/p&gt;
&lt;p&gt;3.
你会发现出现了一个testdata的文件夹, 跟电脑上差不多的操作, 点击进入
&lt;img alt="屏幕快照 2018-07-09 21.53.00" src="https://i.loli.net/2018/07/09/5b4368e5980ac.png"&gt;&lt;/p&gt;
&lt;p&gt;4.
再次点击加号➕图标, 这次选择From Computer
&lt;img alt="屏幕快照 2018-07-09 21.54.22" src="https://i.loli.net/2018/07/09/5b43693e70341.png"&gt;

然后点击Choose files, 会打开本地文件的选择器, 选上要上传的文件.
&lt;img alt="屏幕快照 2018-07-09 21.56.31" src="https://i.loli.net/2018/07/09/5b4369f19e608.png"&gt;
然后upload, 跟发邮件时添加附件的动作没什么区别.
&lt;img alt="屏幕快照 2018-07-09 21.56.55" src="https://i.loli.net/2018/07/09/5b4369f1703ac.png"&gt;&lt;/p&gt;
&lt;h2&gt;设定参数&lt;/h2&gt;
&lt;p&gt;1.
点击Library &amp;gt; Octopus &amp;gt; testdata 中的Octopus, 回到上一级目录
&lt;img alt="屏幕快照 2018-07-09 22.01.53" src="https://i.loli.net/2018/07/09/5b436b2151b69.png"&gt;&lt;/p&gt;
&lt;p&gt;2.
依次进入目录, 到Octopus &amp;gt; python &amp;gt; pdf_parser
&lt;img alt="屏幕快照 2018-07-09 22.04.00" src="https://i.loli.net/2018/07/09/5b436b82038fd.png"&gt;
找到Octopus_VF.ipynb, 点击打开&lt;/p&gt;
&lt;p&gt;3.
打开这个ipynb文件以后, 就进入这样一个页面:
&lt;img alt="屏幕快照 2018-07-09 22.14.14" src="https://i.loli.net/2018/07/09/5b436df1c0a29.png"&gt;
把input_path修改成您刚才设定好的数据文件夹名称, 如果也是使用的testdata, 那就不用修改了.
注意我这里使用的是文件的“相对路径”, ../表示从当前文件夹Octopus &amp;gt; python &amp;gt; pdf_parser退回到上一级Octopus &amp;gt; python, 然后再../退回一级到Octopus, 再进入/testdata.&lt;/p&gt;
&lt;p&gt;output_path可以和input_path一样.&lt;/p&gt;
&lt;p&gt;fname, 如果您需要针对某一个特定文件进行处理, 就把文件名写上, 注意区分大小写, 要带有.pdf的后缀.&lt;/p&gt;
&lt;p&gt;所有的名称都必须在双引号之内.&lt;/p&gt;
&lt;h2&gt;运行&lt;/h2&gt;
&lt;p&gt;1.
把页面一直拖动到最底部,
&lt;img alt="屏幕快照 2018-07-09 22.23.33" src="https://i.loli.net/2018/07/09/5b4370061795e.png"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果是想处理整个文件夹里所有的PDF文件, 就应该是图中这样的形式,&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;process_folder&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;input_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;output_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;save_together&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;save_individual&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;


&lt;ul&gt;
&lt;li&gt;如果想在处理文件夹的同时, 还想把每个PDF文件的数据单独提取成一个csv文件, 就把save_individual=True&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2.
点击顶部菜单中的Kernel, 选择Restart &amp;amp; Run All
&lt;img alt="屏幕快照 2018-07-09 22.26.58" src="https://i.loli.net/2018/07/09/5b4370d34efb6.png"&gt;&lt;/p&gt;
&lt;p&gt;第一次运行的时候会比较慢, 因为用来处理PDF文件的工具包PDFminer.six需要安装. 会看到在import那一堆代码下面出现这样的安装过程, 第二次运行就不会有了.&lt;/p&gt;
&lt;p&gt;&lt;img alt="屏幕快照 2018-07-09 22.47.41" src="https://i.loli.net/2018/07/09/5b4375b8a9be6.png"&gt;
注意, 免费版本的azure notebook会在没有操作后1小时清空所有用户安装的软件包, 所以, 如果第二天再来, 仍然是“第一次”运行的状态. 但之前保存的数据文件不会被消除.&lt;/p&gt;
&lt;p&gt;3.
处理完成的文件会列出来, 如果有处理不了的PDF文件, 比如页面大小不是A4的, 或者是有密码限制了复制功能的, 都会标记出failed
&lt;img alt="屏幕快照 2018-07-09 22.35.45" src="https://i.loli.net/2018/07/09/5b4372d9d0581.png"&gt;&lt;/p&gt;
&lt;h2&gt;取得结果&lt;/h2&gt;
&lt;p&gt;1.
再次回到Octopus &amp;gt; testdata 文件夹之下,
&lt;img alt="屏幕快照 2018-07-09 22.41.31" src="https://i.loli.net/2018/07/09/5b437454be49f.png"&gt;
会看到octopus_data.csv文件已经生成了, 点击Download下载下来即可.&lt;/p&gt;
&lt;p&gt;2.
excel中的数据, 每一行是一个文件中一页的数据, 因为经常病人是做双眼的检查, 但却放在同一个PDF文件里. 如何处理excel中的数据, 就是您自己的事情了.
&lt;img alt="屏幕快照 2018-07-09 22.46.25" src="https://i.loli.net/2018/07/09/5b43756c49355.png"&gt;&lt;/p&gt;
&lt;h2&gt;其他&lt;/h2&gt;
&lt;p&gt;Octupus自家有数据处理软件, 叫&lt;a href="https://www.haag-streit.com/haag-streit-diagnostics/products/perimetry/eyesuite/"&gt;EyeSuite&lt;/a&gt;, 还有人用R语言做好了一个开源的工具包OPI - &lt;a href="https://people.eng.unimelb.edu.au/aturpin/opi/index.html"&gt;Open Perimetry Initiative&lt;/a&gt;, 比我这个高级多了.&lt;/p&gt;
&lt;p&gt;如果没有这些工具包, 那么用我这个小程序还有点意义, 我抓取了视野检查中的values, 也就是检查时的原始数据, 而不仅仅是MD之类统计好的数据.&lt;/p&gt;
&lt;p&gt;比如示例中的这个病人, 4次检查的MD分别是15.2/ 16.5/ 17/ 16.1, 虽然MD在增加, 但好像又有些波动. 那么视野是否在恶化呢?&lt;/p&gt;
&lt;p&gt;MD是平均缺损, 只能反应整体平均的状态. 由于有了原始数据, 聚可以方便分析每个区域了. 比如很简单而不严格的, 我们可以对这4次检查的数据进行一次线性拟合, 得到的斜率如果是负数, 说明越来越差.&lt;/p&gt;
&lt;p&gt;Excel的线性拟合使用LINEST函数.
&lt;img alt="屏幕快照 2018-07-09 22.57.17" src="https://i.loli.net/2018/07/09/5b43787de7cb2.png"&gt;
拖动复制, 对每列的value值都进行这样的操作.
&lt;img alt="屏幕快照 2018-07-09 22.57.37" src="https://i.loli.net/2018/07/09/5b43787e56617.png"&gt;&lt;/p&gt;
&lt;p&gt;注意看这个区域恶化非常明显, 斜率已经分别是-2,-3,-1.8&lt;/p&gt;
&lt;p&gt;&lt;img alt="屏幕快照 2018-07-09 23.01.49" src="https://i.loli.net/2018/07/09/5b4378fe5ec66.png"&gt;&lt;/p&gt;
&lt;p&gt;实际上这个区域对应的是中央视野附近.
&lt;img alt="屏幕快照 2018-07-09 23.03.44" src="https://i.loli.net/2018/07/09/5b4379841f450.png"&gt;
&lt;img alt="屏幕快照 2018-07-09 23.03.52" src="https://i.loli.net/2018/07/09/5b437982e149a.png"&gt;
&lt;img alt="屏幕快照 2018-07-09 23.04.02" src="https://i.loli.net/2018/07/09/5b43798326b1b.png"&gt;
&lt;img alt="屏幕快照 2018-07-09 23.04.09" src="https://i.loli.net/2018/07/09/5b4379840f876.png"&gt;&lt;/p&gt;
&lt;h2&gt;随机森林&lt;/h2&gt;
&lt;p&gt;作为数据读取项目的一部分, octopus数据处理已经可以纳入到随机森林的机器学习功能之中, 详情请参考&lt;a href="https://goldengrape.github.io/posts/python/random-forest-for-ophthalmology-data/"&gt;眼科数据随机森林&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;更新&lt;/h2&gt;
&lt;p&gt;这是一个业余程序员建立的开源项目, 我水平所限不要要求太高. 但我也还是会不断更新的, 修复bug或者添加新功能.&lt;/p&gt;
&lt;p&gt;如果您已经导入到了azure notebooks里面, 也还是可以更新的. 更新代码的方法, 一种是可以新开一个library, 一种是在本library里更新. 如何新开一个之前已经讲过, 下面讲解一下如何更新.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;点击Terminal 图标
&lt;img alt="屏幕快照 2018-07-10 19.18.22" src="https://i.loli.net/2018/07/10/5b449a27d0f60.png"&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;将打开一个命令行界面.
&lt;img alt="屏幕快照 2018-07-10 19.32.20" src="https://i.loli.net/2018/07/10/5b449a70abf86.png"&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;输入如下命令:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;cd library
&lt;/pre&gt;


&lt;p&gt;进入到library文件夹里
&lt;img alt="屏幕快照 2018-07-10 19.41.22" src="https://i.loli.net/2018/07/10/5b449b67dea1a.png"&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;要更新代码, 需要先把之前您修改过的代码清除掉, 否则有冲突. 输入如下命令:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;git checkout .
&lt;/pre&gt;


&lt;p&gt;&lt;img alt="屏幕快照 2018-07-10 19.44.51" src="https://i.loli.net/2018/07/10/5b449c371555d.png"&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;从github上把新代码“拉”到自己的library里. 输入如下命令:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;git pull
&lt;/pre&gt;


&lt;p&gt;&lt;img alt="屏幕快照 2018-07-10 19.46.31" src="https://i.loli.net/2018/07/10/5b449ca3d43d6.png"&gt;&lt;/p&gt;
&lt;p&gt;这样代码就更新完毕了, 关闭页面即可.&lt;/p&gt;
&lt;p&gt;顺便, 推荐一下git, 如果您的电脑上存了很多“最终版”,“最终不变版本”,“最终最终版本”和“赌咒发誓这是最后一版”之类的文件名, 想必知道版本管理的重要性. git是一个很好的版本管理工具, 以后我会再详细讲解.&lt;/p&gt;
&lt;!-- EOF --&gt;&lt;/div&gt;</description><category>python</category><guid>https://goldengrape.github.io/posts/python/octopus-data/</guid><pubDate>Mon, 09 Jul 2018 13:00:00 GMT</pubDate></item><item><title>眼科数据随机森林</title><link>https://goldengrape.github.io/posts/python/random-forest-for-ophthalmology-data/</link><dc:creator>Golden Grape</dc:creator><description>&lt;div&gt;&lt;p&gt;要讲解"随机森林", 先要简介一下"决策树". 各位眼科大夫在眼科门诊每天都在用"决策树", 比如一位单侧眼痛伴同侧头痛的病人进入门诊:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;眼压&amp;gt;21mmHg吗?&lt;ul&gt;
&lt;li&gt;不是, 考虑其他可能&lt;/li&gt;
&lt;li&gt;是的, 考虑青光眼可能, 还有鉴别诊断1, 2, 3..., 进入下一题&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;前房浅吗?&lt;ul&gt;
&lt;li&gt;不是, 考虑其他可能&lt;/li&gt;
&lt;li&gt;是的, 考虑急性闭角型青光眼发作, 还有鉴别诊断x,y,z...,, 进入下一题&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;瞳孔光反射存在吗?&lt;ul&gt;
&lt;li&gt;存在, 考虑其他可能&lt;/li&gt;
&lt;li&gt;瞳孔固定, 考虑急性闭角型青光眼发作, 进入下一题
. . . .&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这就是一颗"决策树", 就是一堆判断题, 一层一层筛选, 最终将数据(病人)分成几类(急闭, 其他)&lt;/p&gt;
&lt;p&gt;"随机森林"就是由一组这样的"决策树"组成的分类器.
&lt;!-- TEASER_END --&gt;&lt;/p&gt;
&lt;h2&gt;随机森林的优劣&lt;/h2&gt;
&lt;h3&gt;优点就是简单好用:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;它对输入的数据没什么特殊要求, 不需要很严格的预处理, 比如不需要归一化, 不需要正态分布化. 定量的数据也行, 定性的数据也行. 完全不挑食.&lt;/li&gt;
&lt;li&gt;它得到模型预测准确率还不差, 甚至使用默认参数也不差. 如果用同样的数据集实验, 不用深度学习的话. 随机森林的准确率大概可以排进前三.&lt;/li&gt;
&lt;li&gt;需要的数据量和运算量, 都还是在可接受范围内, 比如一两百个的数据, 用笔记本电脑跑上几分钟, 也许就能给出不错的结果.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;缺点:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;结果不好解释. 不过大概除了线性模型, 哪个机器学习出来的结果都不好解释.&lt;/li&gt;
&lt;li&gt;还是属于"传统"的机器学习方法. 有些太复杂的问题还是需要深度学习来做.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以, 个人意见是遇到问题先用随机森林试试呗, 不好再换深度学习.&lt;/p&gt;
&lt;h2&gt;随机森林代码&lt;/h2&gt;
&lt;p&gt;通过python scikit-learn建立并且训练一个随机森林模型的代码非常好写, 实际上只有两句话:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;clf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RandomForestClassifier&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;clf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;X_train&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y_train&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;比较复杂的是如何标记数据, 如何把数据读取进来, 如何把数据整理清洗拆分. . .  干些体力活, 得到X_train, y_train这两个东西.&lt;/p&gt;
&lt;p&gt;程序世界的好处是, 体力活大多只需要干一次, 做好模板, 以后就轻松了. 所以我就在这里把眼科这部分的脏活累活先做好.&lt;/p&gt;
&lt;p&gt;目前支持的有医疗设备已经有:
&lt;em&gt; &lt;a href="http://www.zeaomed.com/jmdxty/772.html"&gt;Sirius角膜地形图&lt;/a&gt;
&lt;/em&gt; &lt;a href="https://www.pentacam.com/int/ophthalmologist-with-pentacam.html"&gt;PentaCam角膜地形图&lt;/a&gt;
&lt;em&gt; &lt;a href="http://www.wiskeymedical.com.cn/product/v1049"&gt;Grand Seiko WAM5500视调节力测量仪&lt;/a&gt;
&lt;/em&gt; &lt;a href="https://www.zeiss.com.cn/meditec/products/ophthalmology-optometry/glaucoma/diagnostics/perimetry/humphrey-field-analyzer-3.html"&gt;Humphrey视野(PDF需预先处理)&lt;/a&gt;
* &lt;a href="http://www.gvchina.com/product.aspx?t=1&amp;amp;c=12"&gt;HRT(PDF需预先处理)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;开源项目已经&lt;a href="https://github.com/goldengrape/read_medical_device_data"&gt;放在github上&lt;/a&gt;,
推荐通过&lt;a href="https://goldengrape.github.io/posts/python/random-forest-for-ophthalmology-data/notebooks.azure.com"&gt;微软的azure notebooks&lt;/a&gt;在线使用, 使用azure notebook的教程, 请参考&lt;a href="https://goldengrape.github.io/Python-for-ophthalmologist/"&gt;这篇教程&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;眼科数据随机森林模型的使用方法&lt;/h2&gt;
&lt;h3&gt;上传数据&lt;/h3&gt;
&lt;p&gt;如果你用的是微软azure notebooks, 那么在clone本项目以后, 可以设定成私有项目, 这样再传数据的时候, 不至于泄露给其他人. 你需要用浏览器在云端建立一个目录, 然后把医疗设备的数据报告一个一个上传上去, 看网速吧.&lt;/p&gt;
&lt;p&gt;如果你已经有能力在本地运行python, 甚至装好了anaconda,pandas,scikit-learn, 那无需太多解释, 你只需要把数据放在程序能够找到的路径里即可.&lt;/p&gt;
&lt;h3&gt;PDF数据预处理:&lt;/h3&gt;
&lt;p&gt;目前能够处理的是HRT和Humphrey视野计两种PDF报告, 找到python/pdf_parser目录,&lt;/p&gt;
&lt;p&gt;分别按照HRT.ipynb和Humphrey_VF.ipynb文件中的要求, 修改好路径, 运行. PDF文件的报告会被转换成csv文件.&lt;/p&gt;
&lt;p&gt;csv文件是"逗号分割的"电子表格文件, 可以方便使用excel编辑或者查看, 记得编辑完成后使用"另存为"csv文件.&lt;/p&gt;
&lt;h3&gt;class.csv文件设定&lt;/h3&gt;
&lt;p&gt;需要使用excel编辑这样一个表格, 示例请见\testdata\class.csv
&lt;img alt="屏幕快照 2018-05-14 22.21.30" src="https://i.loli.net/2018/05/14/5af99ba24ed2d.png"&gt;
第一列是class, 记录每一行所代表的病人的诊断, 有病/没病, 也可以有多个诊断.&lt;/p&gt;
&lt;p&gt;之后的每个单元格里填入的是该病人的数据文件名, 其中列标题要注明是哪种设备. (注意大小写, 业余作品不要太挑拣)&lt;/p&gt;
&lt;h3&gt;分析项目设定&lt;/h3&gt;
&lt;p&gt;需要使用excel再编辑一个表格, 示例请见\testdata\analysis_category.csv&lt;/p&gt;
&lt;p&gt;&lt;img alt="屏幕快照 2018-05-14 22.31.13" src="https://i.loli.net/2018/05/14/5af99df6d5270.png"&gt;&lt;/p&gt;
&lt;p&gt;列标题是设备的名称, 每个单元格里是需要分析该设备数据文件中的哪些项目, 项目的名称在各个设备的json中找, (注意大小写, 业余作品不要太挑拣)&lt;/p&gt;
&lt;p&gt;GrandSeikoWAM5500中的项目有:
&lt;em&gt; date: 检查时间
&lt;/em&gt; start_time: 检查开始时间
&lt;em&gt; eye: 眼别
&lt;/em&gt; time: 测量时间点
&lt;em&gt; power: 屈光状态
&lt;/em&gt; pupil: 瞳孔直径&lt;/p&gt;
&lt;p&gt;HRT中的项目有:
&lt;em&gt; "DOB": 出生日期, 操作员不一定都好好填的
&lt;/em&gt; "sex": 性别
&lt;em&gt; "date": 检查时间
&lt;/em&gt; "OS_data":左眼数据
&lt;em&gt; "OD_data":右眼数据
&lt;/em&gt; "Asymmetry_data": 非对称数据
* "classifiction": HRT设备给出的分类诊断, (不建议包含)&lt;/p&gt;
&lt;p&gt;humphrey视野计的项目有:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;"DOB":生日,&lt;/li&gt;
&lt;li&gt;"eye": 眼别&lt;/li&gt;
&lt;li&gt;"date":检查日期&lt;/li&gt;
&lt;li&gt;"False POS Errors":假阳性&lt;/li&gt;
&lt;li&gt;"False NEG Errors":假阴性, 这两个是判定视野检查质量的&lt;/li&gt;
&lt;li&gt;"VFI": 忘了是啥了.&lt;/li&gt;
&lt;li&gt;"MD": 平均缺损, 有重要随访意义&lt;/li&gt;
&lt;li&gt;"PSD": 又忘了是啥了&lt;/li&gt;
&lt;li&gt;"data": 这是二维的视野数据, 在送进随机森林的时候, 会抻成一列使用, 所以左右眼的排布会是不同的.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;pentacam角膜地形图:
"FRONT", "BACK", "Cornea", "Pachy", "Chamber","K",
"Pupil", "X", "Y"
注意, 这些数据里大多也是二维数据, 将抻成一维使用, 左右眼可能会有不同.&lt;/p&gt;
&lt;p&gt;sirius 角膜地形图:
&lt;em&gt; "Radii":,
&lt;/em&gt; "CornealThickness":,
&lt;em&gt; "ElevationAnterior":,
&lt;/em&gt; "ElevationPosterior":,
&lt;em&gt; "RefractiveEquivalentPower":,
&lt;/em&gt; "RefractiveFrontalPowerAnterior":,
&lt;em&gt; "RefractiveFrontalPowerPosterior":,
&lt;/em&gt; "SagittalAnterior":,
&lt;em&gt; "SagittalPosterior":,
&lt;/em&gt; "TangentialAnterior":,
* "TangentialPosterior":
这里面数据好多, 也是注意二维数据的问题, 要注意左右眼的问题.&lt;/p&gt;
&lt;h3&gt;运行随机森林模型&lt;/h3&gt;
&lt;p&gt;随机森林模型在python/random_forest_model.ipynb, 如果设定好class.csv和analysis_category.csv, 大概就不需要什么修改,可以直接训练了,&lt;/p&gt;
&lt;p&gt;训练完成后要观察一下ROC曲线和AUC评分. ROC曲线越靠近左上越好, AUC评分越接近1越好. 在该文件中, 我也有说明如何进行进一步的参数调节和优化. 但, 如果AUC评分巨高就直接发文章好了, 如果AUC评分接近0.5, 就算了吧, 换深度学习方式好了.&lt;/p&gt;
&lt;p&gt;最后, 这是一个业余项目, 代码并不完善, 还在缓慢而持续地改进中.  &lt;/p&gt;
&lt;!-- EOF --&gt;&lt;/div&gt;</description><category>ophthalmology</category><category>python</category><category>现代眼科医生知识扩展包</category><guid>https://goldengrape.github.io/posts/python/random-forest-for-ophthalmology-data/</guid><pubDate>Mon, 14 May 2018 14:00:00 GMT</pubDate></item><item><title>Applied Data Science with Python Specialization小结</title><link>https://goldengrape.github.io/posts/bulabula/Applied-Data-Science-with-Python-Specialization-summary/</link><dc:creator>Golden Grape</dc:creator><description>&lt;div&gt;&lt;p&gt;&lt;a href="https://www.coursera.org/specializations/data-science-python"&gt;Applied Data Science with Python Specialization&lt;/a&gt;
五张证书拿到.&lt;/p&gt;
&lt;p&gt;小结一下这几门课
&lt;!-- TEASER_END --&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;第1门. Introduction to Data Science in Python
讲Pandas基础, 严重推荐, 必学必会.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第2门. Applied Plotting, Charting &amp;amp; Data Representation in Python
讲Matplotlib绘图, 严重推荐, 必学必会&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第3门, Applied Machine Learning in Python
讲scikit learn, 严重不推荐, 建议上youtube随便找找教程也比那个老师讲得好,
理解一下ROC, 知道如何评估模型.
传统机器学习学会随机森林一项即可, 遇到问题一切默认参数先来一把梭, 效果不好就换深度学习了, 不要浪费时间.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第4门, Applied Text Mining in Python
讲NLTK, 如果有处理自然语言的需求可以学学, 普通大众意义不大. 老师幽默风趣, 印度口音十足, 可供练习听力.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;第5门, Applied Social Network Analysis in Python
讲networkX, 推荐, 生物医学化学领域推荐学习, 以此为基础再听听图论可能更佳.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在图像之外的领域, 手工提取feature的技能还是有意义的, 需要借鉴前人的研究基础, 比如自然语言, 图论中的很多预处理的函数, 理解其意义\用途, 很有帮助.&lt;/p&gt;
&lt;p&gt;但在模型构建和训练上, 线性/SVM/决策树之类, 与深度学习相比, 除了需要数据量略少, 其他看起来并没有什么优势.&lt;/p&gt;
&lt;p&gt;随机森林搭建省力, 可以作为基准. gbdt虽然效果类似, 但..RadomForest的名字比较好记. &lt;/p&gt;&lt;/div&gt;</description><category>python</category><guid>https://goldengrape.github.io/posts/bulabula/Applied-Data-Science-with-Python-Specialization-summary/</guid><pubDate>Mon, 16 Apr 2018 17:00:00 GMT</pubDate></item><item><title>Scikit-learn笔记4(ROC曲线)</title><link>https://goldengrape.github.io/posts/python/scikit-learn-note-4/</link><dc:creator>Golden Grape</dc:creator><description>&lt;div tabindex="-1" id="notebook" class="border-box-sizing"&gt;
    &lt;div class="container" id="notebook-container"&gt;

&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;&lt;a href="https://www.coursera.org/learn/python-machine-learning"&gt;Applied Machine Learning in Python&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;这门课实在是太差了. 严重差评:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;"所谓私人恩怨，跟政治就是一回事。所以，如果有哪个白痴政客或者哪个大人物想要推行一项法令或政策，伤害到你或者你亲人朋友的利益，那就是私人恩怨。点燃你的怒火吧。" ----奎尔&lt;/p&gt;
&lt;p&gt;作为报复, 我决定把第三周的ppt给丫翻译了!&lt;/p&gt;
&lt;!-- TEASER_END --&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="决策函数(decision_function)"&gt;决策函数(decision_function)&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/scikit-learn-note-4/#%E5%86%B3%E7%AD%96%E5%87%BD%E6%95%B0(decision_function)"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;分类器对每个测试点都给出一个分数, 这个分数表示分类器预测的可信度. &lt;/li&gt;
&lt;li&gt;选择一个固定的决策阈值就给出了一个分类规则. (大于阈值的就是正分类, 小于阈值的就是负分类)&lt;/li&gt;
&lt;li&gt;通过改变决策阈值, 在所有可能的分数范围内扫描, 我们就可以给出给出一个曲线&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="预测属于某个分类的概率(predict_proba)"&gt;预测属于某个分类的概率(predict_proba)&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/scikit-learn-note-4/#%E9%A2%84%E6%B5%8B%E5%B1%9E%E4%BA%8E%E6%9F%90%E4%B8%AA%E5%88%86%E7%B1%BB%E7%9A%84%E6%A6%82%E7%8E%87(predict_proba)"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;典型的规则: 选择最可能的分类
例如: 如果数值&amp;gt;0.5, 属于分类1&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;通过改变阈值可以调节分类器的预测. &lt;/li&gt;
&lt;li&gt;更高的阈值导致更为保守的分类器&lt;ul&gt;
&lt;li&gt;例如只有数值&amp;gt;0.7才归入分类1&lt;/li&gt;
&lt;li&gt;高阈值增加了precision. 比之前低阈值时更少把样本归入分类1, 但是如果归入到样本1, 那么把握更大. &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;还是举个我更熟悉的例子吧, 比如仅仅用眼压作为青光眼的诊断标准,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;21mmHg就是一个阈值, &lt;/li&gt;
&lt;li&gt;大于21mmHg的就归入青光眼分类, 小于等于21mmHg的就归入正常眼的分类. 但显然这样会把一部分高眼压症的人算作是青光眼. &lt;/li&gt;
&lt;li&gt;如果把阈值提高到比如30mmHg, 那么筛出来的病人, 真正就是青光眼的可能性就要高很多. 就是Precision更高. &lt;/li&gt;
&lt;li&gt;如果把阈值降低到比如15mmHg, 那么就有更少的病人漏网, 也就是Recall更高&lt;/li&gt;
&lt;li&gt;后面会讲半天ROC曲线, 就是看阈值变化时, Precision和Recall的变化. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;del&gt;但是! 在此处吐槽一下. 这样的分类方法明显是错的啊, 本来根本不是用一个值来简单区分的事情, 为什么要强行这么做? 要诊断青光眼还要看视盘, 看盘沿, 看视野, 看动态变化, 本来就不是一个一维的事情, 不管其他, 去找一个参数的分界线是不对的啊. &lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;_贱人就是矫情_&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;(4月4日更正), 此处的吐槽是不对的, 很抱歉. decision_function可以用到不同的分类器上, 是把多维的数据最终映射到一维上, 再拿到一维上来分类, 所以即使是深度学习, 如果是二分类问题, 仍然是最后由一个神经元输出[0, 1]之间的值, 并根据这个值来区分, 比如用sigmoid做激活函数, 那么分界阈值就是0.5, 但实际上可以设定不同. 所以仍然可以得出一个ROC曲线.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="再复习一下各种率"&gt;再复习一下各种率&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/scikit-learn-note-4/#%E5%86%8D%E5%A4%8D%E4%B9%A0%E4%B8%80%E4%B8%8B%E5%90%84%E7%A7%8D%E7%8E%87"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;img src="https://goldengrape.github.io/images/ratios.png" alt=""&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;比如现在只用眼压区分青光眼, 补充一点背景知识: 已知95%的人群眼压是是10-21mmHg, 眼压最低也只能到房水的流出通道, 也就是静脉里面, 最低最低8mmHg, 眼压到30mmHg摸起来已经接近脑门的硬度了, 到40mmHg已经要疼得撞墙了.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;那么, 如果以10mmHg作为分界, 认为大于10mmHg的都是青光眼, 那么几乎所有的人类都是青光眼, 于是没有任何一个青光眼病人会被漏掉. &lt;/li&gt;
&lt;li&gt;如果以40mmHg作为分界, 认为大于40mmHg的才是青光眼, 那么只有急性发作的病人才会被当作是青光眼, 这时候每筛出一个病人, 肯定就是青光眼, 不会筛出来的不是, 但会漏掉很多病人. &lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="Precision-Recall曲线"&gt;Precision-Recall曲线&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/scikit-learn-note-4/#Precision-Recall%E6%9B%B2%E7%BA%BF"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;X轴: Precision&lt;/li&gt;
&lt;li&gt;Y轴: Recall&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;右上顶端:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;理想点&lt;/li&gt;
&lt;li&gt;Precision=1.0&lt;/li&gt;
&lt;li&gt;Recall=1.0&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;P-R曲线的陡峭程度很重要. 在最大Precision时, 能够达到多大的Recall.&lt;br&gt;
&lt;img src="https://i.loli.net/2018/04/01/5ac0be6b687da.png" alt="P-R_curve.png"&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="ROC曲线"&gt;ROC曲线&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/scikit-learn-note-4/#ROC%E6%9B%B2%E7%BA%BF"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;X轴: False Positive Rate 假阳性率&lt;/li&gt;
&lt;li&gt;Y轴: True Positive Rate  真阳性率&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;左上顶点:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;理想点&lt;/li&gt;
&lt;li&gt;False positive rate 假阳性率=0 &lt;/li&gt;
&lt;li&gt;True positive rate 真阳性率=1&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://i.loli.net/2018/04/01/5ac0c250b9182.png" alt="ROC.png"&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;ul&gt;
&lt;li&gt;ROC曲线越往左上, 越好. &lt;/li&gt;
&lt;li&gt;曲线下面积(AUC), 越大越好&lt;/li&gt;
&lt;li&gt;45度线是随机瞎猜线&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://i.loli.net/2018/04/01/5ac0c511e280e.png" alt="ROC-2.png"&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;
&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="未完待续"&gt;未完待续&lt;a class="anchor-link" href="https://goldengrape.github.io/posts/python/scikit-learn-note-4/#%E6%9C%AA%E5%AE%8C%E5%BE%85%E7%BB%AD"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
</description><category>python</category><category>现代眼科医生知识扩展包</category><guid>https://goldengrape.github.io/posts/python/scikit-learn-note-4/</guid><pubDate>Sun, 01 Apr 2018 11:30:00 GMT</pubDate></item><item><title>Scikit-learn笔记3(各种率)</title><link>https://goldengrape.github.io/posts/python/%08scikit-learn-note-3/</link><dc:creator>Golden Grape</dc:creator><description>&lt;div&gt;&lt;p&gt;关于precision, recall的定义, 关于假阳性, 假阴性, 真阳性, 真阴性之类的定义, 我以后一定还是会忘记的.&lt;/p&gt;
&lt;p&gt;而且鉴于我以前凡是两个能够弄混的事情一定可以弄混的特性,&lt;/p&gt;
&lt;p&gt;于是把什么真假阴性阳性扩展到更多的情况, 画了张图&lt;/p&gt;
&lt;p&gt;红色是分子, 灰色是分母. (灰色区域都是包含红色的)&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="https://goldengrape.github.io/images/ratios.png"&gt;&lt;/p&gt;&lt;/div&gt;</description><category>python</category><category>现代眼科医生知识扩展包</category><guid>https://goldengrape.github.io/posts/python/%08scikit-learn-note-3/</guid><pubDate>Sun, 01 Apr 2018 04:00:00 GMT</pubDate></item></channel></rss>